<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es-ES" xml:lang="es-ES"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Javier Rodríguez Barrios y Kenedith Méndez">
<meta name="dcterms.date" content="2023-10-27">

<title>Taller 10.1 Análisis de Clúster - CLA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Taller10.1.cla.peces_files/libs/clipboard/clipboard.min.js"></script>
<script src="Taller10.1.cla.peces_files/libs/quarto-html/quarto.js"></script>
<script src="Taller10.1.cla.peces_files/libs/quarto-html/popper.min.js"></script>
<script src="Taller10.1.cla.peces_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Taller10.1.cla.peces_files/libs/quarto-html/anchor.min.js"></script>
<link href="Taller10.1.cla.peces_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Taller10.1.cla.peces_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Taller10.1.cla.peces_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Taller10.1.cla.peces_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Taller10.1.cla.peces_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


<link rel="stylesheet" href="styles.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#análisis-de-cluster---cla---base-peces" id="toc-análisis-de-cluster---cla---base-peces" class="nav-link active" data-scroll-target="#análisis-de-cluster---cla---base-peces">Análisis de Cluster - CLA - base <em>peces</em></a>
  <ul>
  <li><a href="#referencias-bibliográficas-de-apoyo." id="toc-referencias-bibliográficas-de-apoyo." class="nav-link" data-scroll-target="#referencias-bibliográficas-de-apoyo.">Referencias bibliográficas de apoyo.</a></li>
  <li><a href="#referencias-bibliográficas-de-apoyo.-1" id="toc-referencias-bibliográficas-de-apoyo.-1" class="nav-link" data-scroll-target="#referencias-bibliográficas-de-apoyo.-1">Referencias bibliográficas de apoyo.</a>
  <ul class="collapse">
  <li><a href="#cargar-las-librerías-requeridas" id="toc-cargar-las-librerías-requeridas" class="nav-link" data-scroll-target="#cargar-las-librerías-requeridas">Cargar las librerías requeridas</a></li>
  <li><a href="#cargar-o-importar-la-base-de-datos" id="toc-cargar-o-importar-la-base-de-datos" class="nav-link" data-scroll-target="#cargar-o-importar-la-base-de-datos">Cargar o importar la base de datos</a></li>
  <li><a href="#exploración-de-los-datos" id="toc-exploración-de-los-datos" class="nav-link" data-scroll-target="#exploración-de-los-datos">Exploración de los datos</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#cuatro-pasos-para-el-análisis-de-clúster" id="toc-cuatro-pasos-para-el-análisis-de-clúster" class="nav-link" data-scroll-target="#cuatro-pasos-para-el-análisis-de-clúster">Cuatro pasos para el análisis de clúster</a>
  <ul>
  <li><a href="#paso-1.-distancia-entre-observaciones" id="toc-paso-1.-distancia-entre-observaciones" class="nav-link" data-scroll-target="#paso-1.-distancia-entre-observaciones">PASO 1. Distancia entre observaciones</a></li>
  <li><a href="#paso-2.-elección-del-método-de-agrupación-de-mayor-ajuste" id="toc-paso-2.-elección-del-método-de-agrupación-de-mayor-ajuste" class="nav-link" data-scroll-target="#paso-2.-elección-del-método-de-agrupación-de-mayor-ajuste">PASO 2. Elección del método de agrupación de mayor ajuste</a>
  <ul class="collapse">
  <li><a href="#siete-métodos-de-agrupamiento" id="toc-siete-métodos-de-agrupamiento" class="nav-link" data-scroll-target="#siete-métodos-de-agrupamiento">2.1 Siete métodos de agrupamiento</a></li>
  <li><a href="#figuras-de-los-dendogramas-con-los-siete-métodos-de-agrupamiento" id="toc-figuras-de-los-dendogramas-con-los-siete-métodos-de-agrupamiento" class="nav-link" data-scroll-target="#figuras-de-los-dendogramas-con-los-siete-métodos-de-agrupamiento">2.2 Figuras de los dendogramas con los siete métodos de agrupamiento</a></li>
  <li><a href="#selección-del-mejor-método-de-agrupamiento---correlación-cofenética" id="toc-selección-del-mejor-método-de-agrupamiento---correlación-cofenética" class="nav-link" data-scroll-target="#selección-del-mejor-método-de-agrupamiento---correlación-cofenética">2.3 Selección del mejor método de agrupamiento - Correlación Cofenética</a></li>
  </ul></li>
  <li><a href="#paso-3.-número-de-grupos-formados" id="toc-paso-3.-número-de-grupos-formados" class="nav-link" data-scroll-target="#paso-3.-número-de-grupos-formados">PASO 3. Número de grupos formados</a>
  <ul class="collapse">
  <li><a href="#opción-1.-niveles-de-fusión." id="toc-opción-1.-niveles-de-fusión." class="nav-link" data-scroll-target="#opción-1.-niveles-de-fusión.">Opción 1. Niveles de Fusión.</a></li>
  <li><a href="#opción-2.-número-optimo-de-clusters-de-acuerdo-al-ancho-de-silueta.-índice-de-calidad-de-rousseeuw" id="toc-opción-2.-número-optimo-de-clusters-de-acuerdo-al-ancho-de-silueta.-índice-de-calidad-de-rousseeuw" class="nav-link" data-scroll-target="#opción-2.-número-optimo-de-clusters-de-acuerdo-al-ancho-de-silueta.-índice-de-calidad-de-rousseeuw">Opción 2. Número optimo de clusters de acuerdo al Ancho de silueta. Índice de calidad de Rousseeuw</a></li>
  <li><a href="#figura-del-dendograma-jerárquico-final" id="toc-figura-del-dendograma-jerárquico-final" class="nav-link" data-scroll-target="#figura-del-dendograma-jerárquico-final">3.1 Figura del dendograma jerárquico final</a></li>
  <li><a href="#figura-del-dendograma-no-jerárquico-final" id="toc-figura-del-dendograma-no-jerárquico-final" class="nav-link" data-scroll-target="#figura-del-dendograma-no-jerárquico-final">3.2 Figura del dendograma no jerárquico final</a></li>
  </ul></li>
  <li><a href="#paso-4.-variables-de-mayor-contrinución-a-la-clasificación" id="toc-paso-4.-variables-de-mayor-contrinución-a-la-clasificación" class="nav-link" data-scroll-target="#paso-4.-variables-de-mayor-contrinución-a-la-clasificación">Paso 4. Variables de mayor contrinución a la clasificación</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Taller 10.1 Análisis de Clúster - CLA</h1>
<p class="subtitle lead">Datos de morfométricos de peces de ríos de la India</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Autor/a</div>
    <div class="quarto-title-meta-contents">
             <p>Javier Rodríguez Barrios y Kenedith Méndez </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Fecha de publicación</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 27, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b><section id="análisis-de-cluster---cla---base-peces" class="level1"><b style="color:#1f78b4;">
<h1>Análisis de Cluster - CLA - base <em>peces</em></h1>
</b><p><b style="color:#1f78b4;"></b></p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
<p><strong>Objetivo de la actividad:</strong></p>
</b><p><b style="color:#1f78b4;"></b></p>
<p>La base de datos que se utilizará es la de medidas morfométricas de peces de un estudio realizado con peces de la india por <strong>Gupta et al.&nbsp;(2018)</strong> <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6203374/">Articulo fuente</a> en los que se validó la taxonomía de peces de la subfamilia Barbinae, utilizando 19 variables morfométricas y 19 variables meristicas, correspondientes a 5 especies de la familia en mención.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6203374/bin/pone.0206031.g002.jpg" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption class="figure-caption"><n style="color:#1f78b4;"> Imágen tomada de <em>Gupta et al.&nbsp;(2018)</em> (a) <em>S . Sarana</em> (b) <em>P . ticto</em> (c) <em>P . sóforo</em> , (d) <em>P . conconio</em> y (e) <em>P . chola</em> </n></figcaption><p></p>
</figure>
</div>
<p><strong>El objetivo</strong> de este ejercicio consiste en la realización de un análisis de clúster, basado en cuatro pasos generales (distancia, método de agrupación, número de clúster y selección de variables clasificadoras), para realizar una clasificación de los individuos de peces, basado en las variables morfométricas que los caracterizan. A partir de esa clasificación se generarán unos grupos que pueden compararse con los realizados previamente (grupos= las cinco especies)</p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b><section id="referencias-bibliográficas-de-apoyo." class="level2"><b style="color:#1f78b4;">
<h2 class="anchored" data-anchor-id="referencias-bibliográficas-de-apoyo.">Referencias bibliográficas de apoyo.</h2>
</b><p><b style="color:#1f78b4;"></b></p>
<p><a href="https://github.com/Javier-2712/Libro_andea">Libro: Repositorio de archivos y del “Análisis de datos ecológicos y ambientales” - Rodríguez-Barrios Javier (2022)</a> Ver el capítulo de este libro <a href="https://www-ebooks7-24-com.biblioteca.unimagdalena.edu.co/?il=26489&amp;pg=236">Ejemplo 4. CLÚSTER PARA DATOS DE ABUNDANCIA</a> en donde se detallan los procedimientos que pueden servir de apoyo al presente ejercicio.</p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="referencias-bibliográficas-de-apoyo.-1" class="level2"><b style="color:#1f78b4;">
<h2 class="anchored" data-anchor-id="referencias-bibliográficas-de-apoyo.-1">Referencias bibliográficas de apoyo.</h2>
</b><p><b style="color:#1f78b4;"></b></p>
<p><a href="http://www.scielo.org.co/scielo.php?script=sci_arttext&amp;pid=S0370-39082018000400330">Microalgas de la CGSM - Vidal et al.&nbsp;(2018)</a>. Implementación de un cluster no jerárquico para valorar paleoambientes con microalgas de la Ciénaga Grande de Santa Marta.</p>
<p><a href="https://rpubs.com/kfhidalgoh/300948">Cluster</a> Brinda información complementaria para los diferentes pasos que requiere un análisis de clúster.</p>
<p><a href="https://www.cienciadedatos.net/documentos/37_clustering_y_heatmaps">Clustering y heatmaps</a> Similar al anterior enlace, brinda información detallada sobre el análisis de clúster.</p>
<p><a href="https://rquer.netlify.app/clustering/">Análisis de conglomerados</a> Otro enlace con información general sobre los clúster.</p>
<p><a href="https://rpubs.com/Joaquin_AR/310338">Clustering y heatmaps: aprendizaje no supervisado</a> Aplicación de clúster en diferentes disciplinas.</p>
<p><a href="https://uc-r.github.io/hc_clustering">Hierarchical Cluster Analysis</a> Enlace en el que se encuentra información sobre cluster jerárquicos y técnicas detalladas para seleccionar el número de k - clúster o grupos formados.</p>
<p><a href="https://www.datanovia.com/en/lessons/determining-the-optimal-number-of-clusters-3-must-know-methods/">Determining The Optimal Number Of Clusters</a> Información relevante para el paso 3 de este ejercicio, relacionado a la definición de los k-clúster o el número de grupos formados.</p>
<p><b style="color:#fc8d62;"></b></p><b style="color:#fc8d62;">
<ul>
<li><strong>Clúster no Jerárquicos</strong></li>
</ul>
</b><p><b style="color:#fc8d62;"></b></p>
<p><a href="https://uc-r.github.io/kmeans_clustering#optimal">K-means Cluster Analysis</a> Brinda información sobre la construcción de clúster no jerárquicos.</p>
<p><b style="color:#fc8d62;"></b></p><b style="color:#fc8d62;">
<ul>
<li><strong>Otros</strong></li>
</ul>
</b><p><b style="color:#fc8d62;"></b></p>
<p><a href="https://mran.microsoft.com/snapshot/2017-02-04/web/packages/dendextend/vignettes/introduction.html">Introduction to dendextend</a> El paquete <em>dendextend</em> brinda opciones para comparar y visualizar dendogramas. Esto complementa al paso 3 del presente ejercicio, relacionado a la definición de los k-clúster formados.</p>
<p><a href="http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/117-hcpc-hierarchical-clustering-on-principal-components-essentials/">Hierarchical Clustering on Principal Components</a> Articulación de los clúster en los análisis de componentes principales.</p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b><section id="cargar-las-librerías-requeridas" class="level4"><b style="color:#1f78b4;">
<h4 class="anchored" data-anchor-id="cargar-las-librerías-requeridas">Cargar las librerías requeridas</h4>
</b><p><b style="color:#1f78b4;"></b></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Librerías requeridas</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ellipse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(gclus)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(SciViews)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(ade4)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vegan)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pheatmap)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"gplots"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="cargar-o-importar-la-base-de-datos" class="level4"><b style="color:#1f78b4;">
<h4 class="anchored" data-anchor-id="cargar-o-importar-la-base-de-datos">Cargar o importar la base de datos</h4>
</b><p><b style="color:#1f78b4;"></b></p>
<p>La presente base de datos se encuentra en formato plano de <code>csv</code>, presenta una columna <code>Especie</code> que agrupa a las 5 especies de peces, otra columna <code>Grupo</code>, que asigna un número a cada especie y posteriormente a las 19 variables morfométricas y 10 variables meristicas, de las cuales se selecionarán las 19 morfométricas para este ejercicio <code>M.1</code> a <code>M.19</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Base de datos</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>peces<span class="ot">&lt;-</span><span class="fu">read.csv2</span>(<span class="st">"datos.csv"</span>,<span class="at">row.names=</span><span class="dv">1</span>)  </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="exploración-de-los-datos" class="level4"><b style="color:#1f78b4;">
<h4 class="anchored" data-anchor-id="exploración-de-los-datos">Exploración de los datos</h4>
</b><p><b style="color:#1f78b4;"></b></p>
<p>Para este ejemplo se urtilizarán figuras que relacionan parejas de variables y figuras de cajas que permitan visualizar diferencias entre las especies de peces de acuerdo a su morfometría. *Para facilidad del ejercicio se seleccionarán algunas variables morfométricas - <code>peces1</code>, debido a que son las que presentan mejores patrones lineales.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Elipses con colores con variables morfométricas</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>peces1 <span class="ot">&lt;-</span> peces[,<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>,<span class="dv">15</span>,<span class="dv">17</span>,<span class="dv">20</span>)]</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">cor</span>(peces1)            <span class="co"># Matriz de Correlación (M)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La <a href="#fig-figura1">Figura&nbsp;1</a> permite visualizar las relaciones lineales entre todas las parejas de variables, incluyendo a los coeficientes de correlación de Pearson.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(M,  <span class="at">method =</span> <span class="st">"circle"</span>,            <span class="co"># Correlaciones con circulos</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="st">"lower"</span>, <span class="at">insig=</span><span class="st">"blank"</span>,    <span class="co"># Forma del panel</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">order =</span> <span class="st">"AOE"</span>, <span class="at">diag =</span> <span class="cn">FALSE</span>,      <span class="co"># Ordenar por nivel de correlación</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">addCoef.col =</span><span class="st">"black"</span>,             <span class="co"># Color de los coeficientes</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">number.cex =</span> <span class="fl">0.6</span>,                 <span class="co"># Tamaño del texto</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">COL2</span>(<span class="st">"RdYlBu"</span>, <span class="dv">200</span>))        <span class="co"># Transparencia de los circulos</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller10.1.cla.peces_files/figure-html/fig-figura1-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;1: Correlaciones y coeficientes de correlación.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>La <a href="#fig-figura2">Figura&nbsp;2</a> a diferencia de la anterior, clasifica a los grupos por colores y además incluye a sus coeficientes de correlación y el patrón de distribución de cada variable mediante histogramas de densidad.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>peces1 <span class="ot">&lt;-</span> peces[,<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>,<span class="dv">15</span>,<span class="dv">17</span>,<span class="dv">20</span>)]</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>peces<span class="sc">$</span>Especie <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(peces<span class="sc">$</span>Especie)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span> ((peces1),<span class="at">panel=</span><span class="cf">function</span>(x,y)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>{<span class="fu">abline</span>(<span class="fu">lsfit</span>(x,y)<span class="sc">$</span>coef,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">lowess</span>(x,y),<span class="at">lty=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(x,y,<span class="at">col=</span>peces<span class="sc">$</span>Especie, <span class="at">cex=</span><span class="fl">1.4</span>,<span class="at">pch=</span><span class="dv">19</span>,<span class="at">lwd=</span><span class="fl">0.6</span>)})</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller10.1.cla.peces_files/figure-html/fig-figura2-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;2: Relación entre parejas de variables, por cada grupo en comparación (colores).</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>La <a href="#fig-figura3">Figura&nbsp;3</a> permite visualizar la resolución de cada variable para diferenciar o discriminar a las diferentes especies de peces. Esta figura sirve de insumo para descartar aquellas variables con poco potencial de discriminación de las especies.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figuras multivariadas de Cajas y bigotes</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">melt</span>(peces[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>,<span class="dv">15</span>,<span class="dv">17</span>,<span class="dv">20</span>)]), <span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>value)) <span class="sc">+</span> </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill=</span>Especie)) <span class="sc">+</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'#fc8d59'</span>,<span class="st">'#ffffbf'</span>,<span class="st">'#99d594'</span>,<span class="st">'#377eb8'</span>,<span class="st">'#33a02c'</span>)) <span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">""</span>,<span class="at">y=</span><span class="st">"Morfometría"</span>) <span class="sc">+</span> </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> variable,<span class="at">scales=</span><span class="st">"free"</span>) <span class="sc">+</span> </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller10.1.cla.peces_files/figure-html/fig-figura3-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;3: Variación en la morfometría de los peces, de acuerdo a cada una de las variables seleccionadas.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="cuatro-pasos-para-el-análisis-de-clúster" class="level1"><b style="color:#1f78b4;">
<h1>Cuatro pasos para el análisis de clúster</h1>
</b><p><b style="color:#1f78b4;"></b></p>
<p>A continuación se presenta el paso a paso requerido para un análisis de cluster - cla. Cabe mencionar que es un proceso algo dispendioso en tiempo, pero que brinda la posibilidad de contar con los códigos elaborados para ajustarlos de forma eficiente a otras bases de datos que requieran a este tipo de procedimientos.</p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b><section id="paso-1.-distancia-entre-observaciones" class="level2"><b style="color:#1f78b4;">
<h2 class="anchored" data-anchor-id="paso-1.-distancia-entre-observaciones">PASO 1. Distancia entre observaciones</h2>
</b><p><b style="color:#1f78b4;"></b></p>
<p>Son muchas las distancias que pueden emplearse, pero cada una se ajusta al tipo de datos que se requieran trabajar. Para este caso se usará la <code>distancia euclídea</code>, debido a que se ajusta de manera apropiada a datos ambientales, incorporando además al comando <code>scale</code>, debido a que permite estandarizar a este tipo de variables que presentan escalas disímiles.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matriz de distancia</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>d.euclid <span class="ot">&lt;-</span> <span class="fu">dist</span>(peces[,<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">21</span>)])</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># round(d.euclid,1)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="paso-2.-elección-del-método-de-agrupación-de-mayor-ajuste" class="level2"><b style="color:#1f78b4;">
<h2 class="anchored" data-anchor-id="paso-2.-elección-del-método-de-agrupación-de-mayor-ajuste">PASO 2. Elección del método de agrupación de mayor ajuste</h2>
</b><p><b style="color:#1f78b4;"></b></p>
<p>Son siete las opciones de dendogramas, de las cuales solo una será la que mejor se ajusta a los datos trabajados. Para ello, primero se realizarán los dendogramas y posteriormente se escogerá l de mejor ajuste con la <code>correlación cofenética</code>.</p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b><section id="siete-métodos-de-agrupamiento" class="level3"><b style="color:#1f78b4;">
<h3 class="anchored" data-anchor-id="siete-métodos-de-agrupamiento">2.1 Siete métodos de agrupamiento</h3>
</b><p><b style="color:#1f78b4;"></b></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 1. Vecino más cercano "Cl.single", función "hclust" y método "single"</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>Cl.single <span class="ot">&lt;-</span> <span class="fu">hclust</span>(d.euclid,<span class="at">method=</span><span class="st">"single"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 2. Vecino más lejano "Cl.complete", función "complete"  </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>Cl.complete<span class="ot">&lt;-</span><span class="fu">hclust</span>(d.euclid,<span class="at">method=</span><span class="st">"complete"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 3. UPGMA función "average" Unión Promedio no Ponderado</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>Cl.upgma<span class="ot">&lt;-</span><span class="fu">hclust</span>(d.euclid,<span class="at">method=</span><span class="st">"average"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 4. UPGMC función "mcquitty" Unión Promedio Ponderado</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>Cl.upgmc<span class="ot">&lt;-</span><span class="fu">hclust</span>(d.euclid,<span class="at">method=</span><span class="st">"mcquitty"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 5. WPGMA función "centroid"</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>Cl.wpgma<span class="ot">&lt;-</span><span class="fu">hclust</span>(d.euclid,<span class="at">method=</span><span class="st">"centroid"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 6. WPGMC función "median"</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>Cl.wpgmc<span class="ot">&lt;-</span><span class="fu">hclust</span>(d.euclid,<span class="at">method=</span><span class="st">"median"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 7. WARD, función "ward"</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>Cl.ward<span class="ot">&lt;-</span><span class="fu">hclust</span>(d.euclid,<span class="at">method=</span><span class="st">"ward.D"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="figuras-de-los-dendogramas-con-los-siete-métodos-de-agrupamiento" class="level3"><b style="color:#1f78b4;">
<h3 class="anchored" data-anchor-id="figuras-de-los-dendogramas-con-los-siete-métodos-de-agrupamiento">2.2 Figuras de los dendogramas con los siete métodos de agrupamiento</h3>
</b><p><b style="color:#1f78b4;"></b></p>
<p>A continuación se realizará un panel que contenga hasta 4 figuras de dendogramas (<a href="#fig-figura4">Figura&nbsp;4</a>, <a href="#fig-figura5">Figura&nbsp;5</a>), lo cual permite resumir al número de gráficas generadas, el comando que se empleará para incluir a varias figuras en un mismo panel grafico es <code>grid.arrange()</code> del paquete <code>gridextra</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="fu">fviz_dend</span>(Cl.single, <span class="at">k =</span> <span class="dv">5</span>,        <span class="co"># k grupos (opcionales)</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.7</span>,               <span class="co"># tamaño del texto de las ramas</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Distancia Euclídea"</span>,  <span class="co"># Rotulo de la distancia</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Vecino más Cercano - Single"</span>)  <span class="co"># Rotulo de título</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="fu">fviz_dend</span>(Cl.complete, <span class="at">k =</span> <span class="dv">5</span>,        <span class="co"># k grupos (opcionales)</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.7</span>,               <span class="co"># tamaño del texto de las ramas</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Distancia Euclídea"</span>,  <span class="co"># Rotulo de la distancia</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Vecino más Lejano - Complete"</span>)  <span class="co"># Rotulo de título</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>f3 <span class="ot">&lt;-</span> <span class="fu">fviz_dend</span>(Cl.upgma, <span class="at">k =</span> <span class="dv">5</span>,           <span class="co"># k grupos (opcionales)</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.7</span>,                 <span class="co"># tamaño del texto de las ramas</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Distancia Euclídea"</span>,  <span class="co"># Rotulo de la distancia</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Unión Promedio no Ponderado - upgmc"</span>)  <span class="co"># Rotulo de título</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>f4 <span class="ot">&lt;-</span> <span class="fu">fviz_dend</span>(Cl.upgmc, <span class="at">k =</span> <span class="dv">5</span>,          </span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.7</span>,                 </span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Distancia Euclídea"</span>,  </span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Unión Promedio Ponderado - upgmc"</span>) </span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(f1,f2,f3,f4, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller10.1.cla.peces_files/figure-html/fig-figura4-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;4: Cuatro dendogramas jerárquicos con la distancia euclídea.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>f5 <span class="ot">&lt;-</span> <span class="fu">fviz_dend</span>(Cl.wpgma, <span class="at">k =</span> <span class="dv">5</span>,          </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.7</span>,                 </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Distancia Euclídea"</span>,  </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Unión Centroide no Ponderado - wpgma"</span>) </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>f6 <span class="ot">&lt;-</span> <span class="fu">fviz_dend</span>(Cl.wpgmc, <span class="at">k =</span> <span class="dv">5</span>,          </span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.7</span>,                 </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Distancia Euclídea"</span>,  </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Unión Centroide Ponderado - wpgmc"</span>) </span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>f7 <span class="ot">&lt;-</span> <span class="fu">fviz_dend</span>(Cl.ward, <span class="at">k =</span> <span class="dv">5</span>,          </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.7</span>,                 </span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Distancia Euclídea"</span>,  </span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Método de Ward"</span>) </span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(f5,f6,f7, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura5" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller10.1.cla.peces_files/figure-html/fig-figura5-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;5: Tres dendogramas jerárquicos restantes, con la distancia euclídea.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="selección-del-mejor-método-de-agrupamiento---correlación-cofenética" class="level3"><b style="color:#1f78b4;">
<h3 class="anchored" data-anchor-id="selección-del-mejor-método-de-agrupamiento---correlación-cofenética">2.3 Selección del mejor método de agrupamiento - Correlación Cofenética</h3>
<ul>
<li>2.3.1 Cálculo de las correlaciones cofenéticas</li>
</ul>
</b><p><b style="color:#1f78b4;"></b></p>
<p>El método que presente la mayor correlación cofenética será el seleccionado. Para este caso se escogerá el dendograma con el método upgma, el cuál presenta un cofenético de 0.8494.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (1) Correlación cofenpetica  para "single"</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>cofenet1 <span class="ot">&lt;-</span> <span class="fu">cophenetic</span>(Cl.single)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>simple <span class="ot">=</span> <span class="fu">cor</span>(d.euclid,cofenet1)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>simple</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8226571</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (2) Correlación cofenética  para "complete"</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>cofenet2<span class="ot">&lt;-</span><span class="fu">cophenetic</span>(Cl.complete)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>compl <span class="ot">=</span> <span class="fu">cor</span>(d.euclid,cofenet2)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>compl</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7754882</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (3) Correlación cofenética  para "average"</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>cofenet3<span class="ot">&lt;-</span><span class="fu">cophenetic</span>(Cl.upgma)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>upgma <span class="ot">=</span> <span class="fu">cor</span>(d.euclid,cofenet3)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>upgma</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8494435</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (4) CCorrelación cofenética  para "mcquitty"</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>cofenet4<span class="ot">&lt;-</span><span class="fu">cophenetic</span>(Cl.upgmc)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>upgmc <span class="ot">=</span> <span class="fu">cor</span>(d.euclid,cofenet4)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>upgmc</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8009618</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (5) Correlación cofenética  para "centroid"</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>cofenet5<span class="ot">&lt;-</span><span class="fu">cophenetic</span>(Cl.wpgma)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>wpgma <span class="ot">=</span> <span class="fu">cor</span>(d.euclid,cofenet5)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>wpgma</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6888659</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (6) Correlación cofenética  para "median"</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>cofenet6<span class="ot">&lt;-</span><span class="fu">cophenetic</span>(Cl.wpgmc)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>wpgmc <span class="ot">=</span> <span class="fu">cor</span>(d.euclid,cofenet6)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>wpgmc</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7997027</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (7) Correlación cofenética  para "ward"</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>cofenet7<span class="ot">&lt;-</span><span class="fu">cophenetic</span>(Cl.ward)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>ward <span class="ot">=</span> <span class="fu">cor</span>(d.euclid,cofenet7)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>ward</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.618674</code></pre>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
<ul>
<li>2.3.2 Tabulación de las correlaciones cofenéticas</li>
</ul>
</b><p><b style="color:#1f78b4;"></b></p>
<p>Los siguientes comandos permitirán organizar a los siete métodos de agrupamiento, de acuerdo a su nivel de correlación cofenética.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data frame con cofenéticos</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>cofeneticos <span class="ot">=</span> <span class="fu">data.frame</span>(simple,compl,upgma,upgmc,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>                         wpgma,wpgmc,ward)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co"># cofenéticos por cada métodos (Met)</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>cofenet<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">Met =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>,<span class="at">Cofen=</span><span class="fu">t</span>(<span class="fu">round</span>(cofeneticos,<span class="dv">3</span>)))</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="co"># tabla con orden descendente de cofenéticos</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>cof_ordenado <span class="ot">=</span> cofenet[<span class="fu">order</span>(cofenet<span class="sc">$</span>Cofen, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ]</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>cof_ordenado</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Met Cofen
upgma    3 0.849
simple   1 0.823
upgmc    4 0.801
wpgmc    6 0.800
compl    2 0.775
wpgma    5 0.689
ward     7 0.619</code></pre>
</div>
</div>
<p>Con este comando se puede exportar la tabla de cofenéticos como un archivo plano de <code>csv</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># guardar tabla como csv</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv2(cof_ordenado,"cofenet.csv")</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
<ul>
<li>2.3.3 Figuras de algunas correlaciones cofenéticas vs.&nbsp;matriz de distancia</li>
</ul>
</b><p><b style="color:#1f78b4;"></b></p>
<p>A continuación se presenta una muestra de la relación entre las matrices de distancia cofenética y de distancia euclínea, que permitió seleccionar al mejor método de agrupamiento (<a href="#fig-figura6">Figura&nbsp;6</a>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convertir matricesde distancia a vectores</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>d.euclid <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(d.euclid)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>d.cofenet1 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(cofenet1)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>d.cofenet2 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(cofenet2)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>d.cofenet3 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(cofenet3)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>d.cofenet4 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(cofenet4)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co"># crear un data frame con los vectores y agregar una columna de etiquetas</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>simple1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(d.euclid, d.cofenet1, d.cofenet2, d.cofenet3, d.cofenet4)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(simple1)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   d.euclid d.cofenet1 d.cofenet2 d.cofenet3 d.cofenet4
1 0.5737595   0.349285  0.6743145  0.5756145  0.5788911
2 0.5601785   0.349285  0.6743145  0.5756145  0.5788911
3 0.6151423   0.349285  0.6743145  0.5756145  0.5788911
4 0.5746303   0.349285  0.6743145  0.5756145  0.5788911
5 0.5673623   0.349285  0.6743145  0.5756145  0.5788911
6 0.5413871   0.349285  0.6743145  0.5756145  0.5788911</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figuras correlaciones cofenéticas</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (1) distancia cofenética  para "unión simple" </span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>f1<span class="ot">&lt;-</span><span class="fu">ggplot</span>(simple1, <span class="fu">aes</span>(d.euclid,d.cofenet1))<span class="sc">+</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">1.5</span>, <span class="at">color=</span><span class="st">"#4daf4a"</span>) <span class="sc">+</span> </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>,<span class="at">se=</span><span class="cn">FALSE</span>,<span class="at">color=</span><span class="st">"#377eb8"</span>) <span class="sc">+</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"loess"</span>,<span class="at">se=</span><span class="cn">FALSE</span>,<span class="at">color =</span><span class="st">"#e41a1c"</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">size=</span><span class="fl">1.3</span>) <span class="sc">+</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Unión Simple"</span>,</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span> <span class="fu">paste</span>(<span class="st">"Correlación cofenética"</span>,</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="fu">cor</span>(d.euclid,cofenet1),<span class="dv">4</span>)),</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Distancia Euclidea"</span>,</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Distancia cofenética"</span>) <span class="sc">+</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="co"># (2) distancia cofenética  para "unión completa" </span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>f2<span class="ot">&lt;-</span><span class="fu">ggplot</span>(simple1, <span class="fu">aes</span>(d.euclid,d.cofenet2))<span class="sc">+</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">1.5</span>, <span class="at">color=</span><span class="st">"#4daf4a"</span>) <span class="sc">+</span> </span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>,<span class="at">se=</span><span class="cn">FALSE</span>,<span class="at">color=</span><span class="st">"#377eb8"</span>) <span class="sc">+</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"loess"</span>,<span class="at">se=</span><span class="cn">FALSE</span>,<span class="at">color =</span><span class="st">"#e41a1c"</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">size=</span><span class="fl">1.3</span>) <span class="sc">+</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Unión Completa"</span>,</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span> <span class="fu">paste</span>(<span class="st">"Correlación cofenética"</span>,</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="fu">cor</span>(d.euclid,cofenet2),<span class="dv">4</span>)),</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Distancia Euclidea"</span>,</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Distancia cofenética"</span>) <span class="sc">+</span></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a><span class="co"># (3) distancia cofenética  para "unión upgma" </span></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>f3<span class="ot">&lt;-</span><span class="fu">ggplot</span>(simple1, <span class="fu">aes</span>(d.euclid,d.cofenet3))<span class="sc">+</span></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">1.5</span>, <span class="at">color=</span><span class="st">"#4daf4a"</span>) <span class="sc">+</span> </span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>,<span class="at">se=</span><span class="cn">FALSE</span>,<span class="at">color=</span><span class="st">"#377eb8"</span>) <span class="sc">+</span></span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"loess"</span>,<span class="at">se=</span><span class="cn">FALSE</span>,<span class="at">color =</span><span class="st">"#e41a1c"</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">size=</span><span class="fl">1.3</span>) <span class="sc">+</span></span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Unión promedio no ponderado - upgma"</span>,</span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span> <span class="fu">paste</span>(<span class="st">"Correlación cofenética"</span>,</span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="fu">cor</span>(d.euclid,cofenet3),<span class="dv">4</span>)),</span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Distancia Euclidea"</span>,</span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Distancia cofenética"</span>) <span class="sc">+</span></span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a><span class="co"># (4) distancia cofenética  para "unión upgmc" </span></span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>f4<span class="ot">&lt;-</span><span class="fu">ggplot</span>(simple1, <span class="fu">aes</span>(d.euclid,d.cofenet4))<span class="sc">+</span></span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">1.5</span>, <span class="at">color=</span><span class="st">"#4daf4a"</span>) <span class="sc">+</span> </span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>,<span class="at">se=</span><span class="cn">FALSE</span>,<span class="at">color=</span><span class="st">"#377eb8"</span>) <span class="sc">+</span></span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"loess"</span>,<span class="at">se=</span><span class="cn">FALSE</span>,<span class="at">color =</span><span class="st">"#e41a1c"</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">size=</span><span class="fl">1.3</span>) <span class="sc">+</span></span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Unión promedio ponderado - upgmc"</span>,</span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span> <span class="fu">paste</span>(<span class="st">"Correlación cofenética"</span>,</span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="fu">cor</span>(d.euclid,cofenet4),<span class="dv">4</span>)),</span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Distancia Euclidea"</span>,</span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Distancia cofenética"</span>) <span class="sc">+</span></span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(f1,f2,f3,f4, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura6" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller10.1.cla.peces_files/figure-html/fig-figura6-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;6: Cuatro regresiones entre la distancia euclídea empleada y las distancias cofenéticas de cada método de agrupamiento definido.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="paso-3.-número-de-grupos-formados" class="level2"><b style="color:#1f78b4;">
<h2 class="anchored" data-anchor-id="paso-3.-número-de-grupos-formados">PASO 3. Número de grupos formados</h2>
</b><p><b style="color:#1f78b4;"></b></p>
<p>La definición de los grupos formados, representan un insumo importante de información, debido a que permiten generar los k cluster en los que se agrupan las observaciones, basado en las variables que las caracterizan. Este insumo es relevante además, como paso previo a otras técnicas que requieren los grupos definidos a priori, como los análisis discriminantes lineales (lda) o los análisis de varianza multivariados (manovas), de igual forma, a partir de los grupos se pueden responder hipótesis enfocadas en las variaciones que pueden presentar las variables a lo largo de gradientes discretos o en cluster.</p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b><section id="opción-1.-niveles-de-fusión." class="level3"><b style="color:#1f78b4;">
<h3 class="anchored" data-anchor-id="opción-1.-niveles-de-fusión.">Opción 1. Niveles de Fusión.</h3>
</b><p><b style="color:#1f78b4;"></b></p>
<p>La figura de niveles de fusión es una de las más utilizadas para la generación de grupos o de cluster, debido a la sencillez del componente gráfico, en el cual se definen los cluster o grupos (eje Y), dependiendo del escalón de mayor amplitud o distancia horizontal (eje X). En la <a href="#fig-figura7">Figura&nbsp;7</a> se observa que la mayor amplitud se presenta en 2 k cluster, por lo cual, el dendograma seleccionado en el paso anterior se puede clasificar en dos grupos de observaciones.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Base de variables a relacionar (amb)</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>amb <span class="ot">&lt;-</span> peces[,<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>,<span class="dv">15</span>,<span class="dv">17</span>,<span class="dv">20</span>)]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear un data.frame con los datos de altura, k y número de cluster</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">h =</span> Cl.upgma<span class="sc">$</span>height, <span class="at">k =</span> <span class="fu">nrow</span>(amb)<span class="sc">:</span><span class="dv">2</span>, <span class="at">cluster =</span> <span class="fu">nrow</span>(amb)<span class="sc">:</span><span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear el gráfico de dispersión y agregar etiquetas de texto</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(f1, <span class="fu">aes</span>(<span class="at">x =</span> h, <span class="at">y =</span> k, <span class="at">label =</span> cluster)) <span class="sc">+</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_step</span>(<span class="at">color =</span> <span class="st">"grey"</span>, <span class="at">direction =</span> <span class="st">"vh"</span>) <span class="sc">+</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Personalizar el gráfico con títulos, etiquetas de ejes y paleta de colores</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Niveles de Fusión - Distancia Euclídea - UPGMA"</span>) <span class="sc">+</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"k (Número de Cluster)"</span>) <span class="sc">+</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"h (Altura del Nodo)"</span>) <span class="sc">+</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"grey"</span>, <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>)) <span class="sc">+</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura7" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller10.1.cla.peces_files/figure-html/fig-figura7-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;7: Cuatro regresiones entre la distancia euclídea empleada y las distancias cofenéticas de cada método de agrupamiento definido.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="opción-2.-número-optimo-de-clusters-de-acuerdo-al-ancho-de-silueta.-índice-de-calidad-de-rousseeuw" class="level3"><b style="color:#1f78b4;">
<h3 class="anchored" data-anchor-id="opción-2.-número-optimo-de-clusters-de-acuerdo-al-ancho-de-silueta.-índice-de-calidad-de-rousseeuw">Opción 2. Número optimo de clusters de acuerdo al Ancho de silueta. Índice de calidad de Rousseeuw</h3>
</b><p><b style="color:#1f78b4;"></b></p>
<p>La amplitud de silueta es de las opciones más usadas para definir al número de k cluster o grupos del dendograma realizado. En este ejercicio también se define a dos grupos. En caso que los resultados de esta técnica sean diferentes a la anterior, se suele decidir por esta, debido a su mayor grado de precisión.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Base de datos (amb)</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>amb <span class="ot">&lt;-</span> peces[,<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>,<span class="dv">15</span>,<span class="dv">17</span>,<span class="dv">20</span>)]</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Distancia utilizada (d.euclid)</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>d.euclid <span class="ot">&lt;-</span> <span class="fu">dist</span>(peces[,<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">21</span>)])</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Método de agrupamiento seleccionado (cl.upgma)</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>Cl.upgma<span class="ot">&lt;-</span><span class="fu">hclust</span>(d.euclid,<span class="at">method=</span><span class="st">"average"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Crear un vector vacío (amb.vacio) con asw valores</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>amb.vacio <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">nrow</span>(amb))</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Silueta "sil" </span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span> (<span class="fu">nrow</span>(amb)<span class="sc">-</span><span class="dv">1</span>)){</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    sil <span class="ot">&lt;-</span> <span class="fu">silhouette</span>(<span class="fu">cutree</span>(Cl.upgma,<span class="at">k=</span>k),d.euclid)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    amb.vacio[k]<span class="ot">&lt;-</span><span class="fu">summary</span>(sil)<span class="sc">$</span>avg.width} </span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Mejor o mayor amplitud de silueta (2 particiones)</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>k.mejor <span class="ot">&lt;-</span> <span class="fu">which.max</span>(amb.vacio)</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>k.mejor </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Grafica de silueta</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(amb),amb.vacio,<span class="at">type=</span><span class="st">"h"</span>,</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Silueta-Número Óptimo de Clusters"</span>, <span class="at">xlab=</span><span class="st">"(Número de grupos)"</span>,</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Amplitud promedio de  silueta"</span>)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>,k.mejor,<span class="fu">paste</span>(<span class="st">"optimum"</span>,k.mejor,<span class="at">sep=</span><span class="st">"</span><span class="sc">\n</span><span class="st">"</span>),<span class="at">col=</span><span class="st">"red"</span>,</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">font=</span><span class="dv">2</span>,<span class="at">col.axis=</span><span class="st">"red"</span>)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(k.mejor,<span class="fu">max</span>(amb.vacio),<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span><span class="st">"red"</span>,<span class="at">cex=</span><span class="fl">1.5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Taller10.1.cla.peces_files/figure-html/unnamed-chunk-27-1.svg" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">""</span>,<span class="st">"Silueta-Número óptimo de Clusters k="</span>,k.mejor,</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>,<span class="st">"Con una aplitud promedio de silueta"</span>,<span class="fu">max</span>(amb.vacio),<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Silueta-Número óptimo de Clusters k= 3 
 Con una aplitud promedio de silueta 0.3662872 </code></pre>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="figura-del-dendograma-jerárquico-final" class="level3"><b style="color:#1f78b4;">
<h3 class="anchored" data-anchor-id="figura-del-dendograma-jerárquico-final">3.1 Figura del dendograma jerárquico final</h3>
</b><p><b style="color:#1f78b4;"></b></p>
<p>La <a href="#fig-figura8">Figura&nbsp;8</a> muestra la manera en la que se organizan las observaciones en los dos grupos formados (ramas rojas y azules) devido a la naturaleza de las variables morfométricas que las caracterizar.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dendograma final </span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_dend</span>(Cl.upgma, <span class="at">k =</span> <span class="dv">3</span>,        <span class="co"># k grupos</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.6</span>,              <span class="co"># tamaño del texto de las observaciones</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Distancia Euclídea"</span>,  <span class="co"># Rotulo de la distancia</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Unión Promedio no Ponderada (UPGMA)"</span>, <span class="co"># Rotulo de título</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">lower_rect =</span> <span class="dv">0</span>,           <span class="co"># Inicio de los rectángulos en cero</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">k_colors =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>,<span class="st">"#FC4E07"</span>),</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">color_labels_by_k =</span> <span class="cn">TRUE</span>,    <span class="co"># Colores para cada grupo</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">rect =</span> <span class="cn">TRUE</span>)                 <span class="co"># Rectángulos de cada grupo</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura8" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller10.1.cla.peces_files/figure-html/fig-figura8-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;8: Dendograma jerárquico final con los dos grupos asignados.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Vale la pena mencionar que estos análisis son importantes cuando se cuenta con pocas observaciones (ramas del dendograma), en el caso contrario, es preferible utilizar dendogramas no jerarquicos como el k-meas, el cual fue descrito en uno de los complementos del PCA y se retoma a continuación.</p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="figura-del-dendograma-no-jerárquico-final" class="level3"><b style="color:#1f78b4;">
<h3 class="anchored" data-anchor-id="figura-del-dendograma-no-jerárquico-final">3.2 Figura del dendograma no jerárquico final</h3>
</b><p><b style="color:#1f78b4;"></b></p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
<ul>
<li>Agrupamiento elegido en el paso 2 (upgma)</li>
</ul>
</b><p><b style="color:#1f78b4;"></b></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matriz de distancia</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>d.euclid <span class="ot">&lt;-</span> <span class="fu">dist</span>(peces[,<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">21</span>)])</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 3. UPGMA función "average" Unión Promedio no Ponderado</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>Cl.upgma<span class="ot">&lt;-</span><span class="fu">hclust</span>(d.euclid,<span class="at">method=</span><span class="st">"average"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
<ul>
<li>Generación de la variable agrupadora (<strong>gr</strong>)</li>
</ul>
</b><p><b style="color:#1f78b4;"></b></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable agrupadora con k=3 clúster</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>grp <span class="ot">&lt;-</span> <span class="fu">cutree</span>(Cl.upgma, <span class="at">k =</span> <span class="dv">3</span>)    <span class="co"># Grupos generados "grp"  </span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>grl <span class="ot">&lt;-</span> <span class="fu">levels</span>(<span class="fu">factor</span>(grp))        <span class="co"># Rotulos de los grupos formados</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Este es un paso opcional en caso que se requiera insertar la nueva variable agrupadora a la base de datos en revisión.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Incluir la variable agrupadora en la base de datos</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>peces<span class="fl">.1</span><span class="ot">=</span><span class="fu">data.frame</span>(grp,peces)       <span class="co"># Nuevo dataframe con la variable agrupadora (gr)</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span> (peces<span class="fl">.1</span>[,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>])  <span class="co"># Visualización de las 5 primeras variables morfométricas</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  grp  Especie Grupo  M.1  M.2  M.3  M.4  M.5
1   1 P. chola     1 0.36 0.87 0.25 0.29 0.10
2   2 P. chola     1 0.39 0.88 0.27 0.26 0.11
3   2 P. chola     1 0.36 0.87 0.25 0.28 0.10
4   2 P. chola     1 0.38 0.89 0.27 0.32 0.14
5   2 P. chola     1 0.39 0.88 0.27 0.31 0.12
6   2 P. chola     1 0.40 0.93 0.29 0.32 0.12</code></pre>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
<ul>
<li>Generación del clúster No Jerárquico (<strong>K-Means</strong>)</li>
</ul>
</b><p><b style="color:#1f78b4;"></b></p>
<p>La <a href="#fig-figura9">Figura&nbsp;9</a> es la forma no jerárquica de presentar los resultados del cluster definido por el método de agrupamiento <code>upgma</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(<span class="fu">list</span>(<span class="at">data =</span> amb, <span class="at">cluster =</span> grp),</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">'#fc8d59'</span>,<span class="st">'#377eb8'</span>,<span class="st">'#99d594'</span>),  <span class="co"># Colores para cada grupo</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">ellipse.type =</span> <span class="st">"confidence"</span>,        <span class="co"># Elipses</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">repel =</span> <span class="cn">TRUE</span>,                 <span class="co"># Elimina solapamiento de observaciones</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">show.clust.cent =</span> <span class="cn">FALSE</span>,      <span class="co"># Muestra a los clúster centrados</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>())     <span class="co"># Tipo de fondo tomado de ggplot2</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura9" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller10.1.cla.peces_files/figure-html/fig-figura9-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;9: Dendograma no jerárquico final con los tres grupos asignados.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Una pregunta interesante que se podría resolver, sería valorar si las diferencias entre los dos grupos de observaciones formadas es estadísticamente significativa, para lo cual se debe aplicar un análisis de varianza multivariado (manova).</p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="paso-4.-variables-de-mayor-contrinución-a-la-clasificación" class="level2"><b style="color:#1f78b4;">
<h2 class="anchored" data-anchor-id="paso-4.-variables-de-mayor-contrinución-a-la-clasificación">Paso 4. Variables de mayor contrinución a la clasificación</h2>
</b><p><b style="color:#1f78b4;"></b></p>
<p>A continuación se realizan diferentes opciones de <strong>mapas de calor</strong> (<a href="#fig-figura10">Figura&nbsp;10</a>, <a href="#fig-figura11">Figura&nbsp;11</a>), para identifiar a las variables con mayor relevancia en la clasificación realizada anteriormente en el dendograma seleccionado. Este paso es relevante cuando se quiere ponderar o seleecionar a las variables que aportan al análisis, resumiento de esta forma, la dimensionalidad del problema (número de variables).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>amb1 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(amb)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Opción 1. Mapa de calor con paquete "stats"</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>hv <span class="ot">&lt;-</span> <span class="fu">heatmap</span>(amb1, <span class="at">margins=</span><span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">6</span>), </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">distfun =</span> dist,</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">xlab =</span><span class="st">"Variables Morfométricas"</span>,</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">ylab=</span> <span class="st">"Peces"</span>, </span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">main =</span> <span class="st">"Clasificación de Peces"</span>,</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">scale =</span> <span class="st">"row"</span>)   <span class="co"># Estandariza variables diferentes.</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura10" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller10.1.cla.peces_files/figure-html/fig-figura10-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;10: Mapa de calor que define en color rojo a las variables de mayor aporte a la clasificación realizada.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>El siguiente mapa de calor (<a href="#fig-figura11">Figura&nbsp;11</a>) incorpora a la distancia euclídea utilizada y el método de agrupamiento seleccionado (upgma).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Opción 2. Mapa de calor con paquete "stats"</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>hclust.fq <span class="ot">&lt;-</span> <span class="cf">function</span>(amb1) <span class="fu">hclust</span>(amb1, <span class="at">method=</span><span class="st">"average"</span>)   <span class="co"># Inserción de agrupación UPGMA</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap.2</span>(amb1,               <span class="co"># Base de datos en formato matricial</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">margins=</span><span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">7</span>),     <span class="co"># Margenes de la figura</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">scale =</span> <span class="st">"row"</span>,      <span class="co"># Estandariza variables diferentes.</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="fu">bluered</span>(<span class="dv">100</span>),                 <span class="co"># Colores del mapa de calor</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span><span class="st">"Variables Morfométricas"</span>,</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab=</span> <span class="st">"Peces"</span>, </span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Clasificación de Peces"</span>,</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">trace =</span> <span class="st">"none"</span>, </span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">density.info =</span> <span class="st">"none"</span>,</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">distfun =</span> dist,          <span class="co"># Se puede usar vegdist de "vegan" </span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">hclustfun=</span>hclust.fq)     <span class="co"># Agrupamiento UPGMA</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura11" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller10.1.cla.peces_files/figure-html/fig-figura11-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;11: Mapa de calor que define en color rojo a las variables de mayor aporte a la clasificación realizada.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>El siguiente mapa de calor (<strong>?@fig-figura12</strong>) permite visualizar a la resolución de las variables morfométricas para diferenciar a los grupos de especies, las cuales representan a los grupos en comparación. Con los siguientes comandos se calculará una tabla que resume a los <code>promedios</code> de las 7 variables ambientales para cada grupo evaluado.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracción de los promedios de las variables para cada sitio</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>promedios <span class="ot">&lt;-</span> peces <span class="sc">%&gt;%</span>      </span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="st">"Especie"</span>,<span class="st">"M.1"</span>,<span class="st">"M.2"</span>,<span class="st">"M.3"</span>,<span class="st">"M.4"</span>,<span class="st">"M.5"</span>,<span class="st">"M.6"</span>,<span class="st">"M.7"</span>,<span class="st">"M.8"</span>,<span class="st">"M.9"</span>,<span class="st">"M.10"</span>,<span class="st">"M.11"</span>,<span class="st">"M.12"</span>, </span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">"M.13"</span>,<span class="st">"M.14"</span>,<span class="st">"M.15"</span>,<span class="st">"M.16"</span>,<span class="st">"M.17"</span>,<span class="st">"M.18"</span>,<span class="st">"M.19"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Especie) <span class="sc">%&gt;%</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), mean))</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>promedios  <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(promedios) <span class="co"># Guardar promedios como dataframe</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a><span class="co"># promedios</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A continuación se comvierte el dataframe a formato matricial - <code>promedios2</code>, para poder ser graficado en el mapa de calor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Seleccionar columnas de 2 a 10 del data frame peces1 y convertirlas en matriz</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>promedios2 <span class="ot">&lt;-</span> promedios <span class="sc">%&gt;%</span> </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>              <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">19</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">as.matrix</span>()</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(promedios2[,<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>],<span class="dv">2</span>) <span class="co"># Visualización de las 10 primeras variables</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   M.1  M.2  M.3  M.4  M.5  M.6  M.7  M.8  M.9 M.10
1 0.38 0.87 0.27 0.30 0.11 0.12 0.69 0.65 0.72 0.78
2 0.32 0.76 0.25 0.25 0.11 0.13 0.66 0.71 0.72 0.85
3 0.36 0.85 0.26 0.29 0.11 0.13 0.68 0.63 0.72 0.84
4 0.37 0.90 0.26 0.28 0.13 0.15 0.70 0.72 0.70 0.84
5 0.48 0.76 0.28 0.31 0.13 0.16 0.88 0.63 0.77 0.84</code></pre>
</div>
</div>
<p>Ahora se incluyen los nombres de los grupos (S1 y S2) a la matriz <code>promedios2</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Asignar los valores de la primera columna de peces1 como nombres de fila en la matriz peces2</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(promedios2) <span class="ot">&lt;-</span> promedios[,<span class="dv">1</span>]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La <a href="#fig-figura13">Figura&nbsp;12</a> permite visualizar a las variables que mejor discriminan a los grupos de especies (variables de tonalidad rojiza).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figura del primer mapa de calor</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>hv <span class="ot">&lt;-</span> <span class="fu">heatmap</span>(promedios2, </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">margins =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">12</span>), </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">distfun =</span> dist,</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">xlab =</span><span class="st">"Variables Morfométricas"</span>, </span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">ylab=</span> <span class="st">"Grupos de especies de peces"</span>, </span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">main =</span> <span class="st">"Clasificación de Peces"</span>) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura13" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller10.1.cla.peces_files/figure-html/fig-figura13-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;12: Mapa de calor que relaciona a las variables morfométricas y a los grupos de cada especie.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>La <a href="#fig-figura14">Figura&nbsp;13</a> incorpora elementos adicionales como al método de agrupamiento <code>upgma</code>, asumiendo que puede ser el que mejor se ajusta a los datos de este ejercicio.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Opción 2. Mapa de calor con paquete "stats"</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>hclust.fq <span class="ot">&lt;-</span> <span class="cf">function</span>(promedios2) </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>             <span class="fu">hclust</span>(promedios2, <span class="at">method=</span><span class="st">"average"</span>)   <span class="co"># Inserción de UPGMA</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"gplots"</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap.2</span>(promedios2,         <span class="co"># Base de datos en formato matricial</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">margins=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">12</span>),    <span class="co"># Margenes de la figura</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">scale =</span> <span class="st">"row"</span>,      <span class="co"># Estandariza variables diferentes.</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="fu">bluered</span>(<span class="dv">100</span>),                 <span class="co"># Colores del mapa de calor</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span><span class="st">"Variables morfométricas"</span>, </span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab=</span> <span class="st">"Grupos de Especies"</span>, </span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Clasificación de Peces"</span>,   </span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">trace =</span> <span class="st">"none"</span>, </span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">density.info =</span> <span class="st">"none"</span>,</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">distfun =</span> dist,          <span class="co"># Se puede usar vegdist de "vegan" </span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">hclustfun=</span>hclust.fq)     <span class="co"># Agrupamiento UPGMA</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura14" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller10.1.cla.peces_files/figure-html/fig-figura14-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;13: Mapa de calor que relaciona a las variables morfométricas y a los grupos de especies.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script>
</div> <!-- /content -->



</body></html>