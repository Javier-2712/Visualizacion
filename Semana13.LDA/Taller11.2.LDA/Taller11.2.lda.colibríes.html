<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es-ES" xml:lang="es-ES"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Javier Rodríguez Barrios">
<meta name="dcterms.date" content="2023-05-05">

<title>Taller 11.2 Análisis Discriminante Lineal - LDA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Taller11.2.lda.colibríes_files/libs/clipboard/clipboard.min.js"></script>
<script src="Taller11.2.lda.colibríes_files/libs/quarto-html/quarto.js"></script>
<script src="Taller11.2.lda.colibríes_files/libs/quarto-html/popper.min.js"></script>
<script src="Taller11.2.lda.colibríes_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Taller11.2.lda.colibríes_files/libs/quarto-html/anchor.min.js"></script>
<link href="Taller11.2.lda.colibríes_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Taller11.2.lda.colibríes_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Taller11.2.lda.colibríes_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Taller11.2.lda.colibríes_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Taller11.2.lda.colibríes_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


<link rel="stylesheet" href="styles.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#análisis-discriminante-lineal---lda---base-colibríes" id="toc-análisis-discriminante-lineal---lda---base-colibríes" class="nav-link active" data-scroll-target="#análisis-discriminante-lineal---lda---base-colibríes">Análisis Discriminante Lineal - LDA - base <em>colibríes</em></a>
  <ul>
  <li><a href="#referencias-bibliográficas-de-apoyo." id="toc-referencias-bibliográficas-de-apoyo." class="nav-link" data-scroll-target="#referencias-bibliográficas-de-apoyo.">Referencias bibliográficas de apoyo.</a>
  <ul class="collapse">
  <li><a href="#cargar-las-librerías-requeridas" id="toc-cargar-las-librerías-requeridas" class="nav-link" data-scroll-target="#cargar-las-librerías-requeridas">Cargar las librerías requeridas</a></li>
  <li><a href="#cargar-o-importar-la-base-de-datos" id="toc-cargar-o-importar-la-base-de-datos" class="nav-link" data-scroll-target="#cargar-o-importar-la-base-de-datos">Cargar o importar la base de datos</a></li>
  <li><a href="#exploración-de-los-datos" id="toc-exploración-de-los-datos" class="nav-link" data-scroll-target="#exploración-de-los-datos">Exploración de los datos</a>
  <ul class="collapse">
  <li><a href="#mapa-de-calor" id="toc-mapa-de-calor" class="nav-link" data-scroll-target="#mapa-de-calor">Mapa de Calor</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  <li><a href="#tres-pasos-para-la-realización-del-discriminante-lineal---lda" id="toc-tres-pasos-para-la-realización-del-discriminante-lineal---lda" class="nav-link" data-scroll-target="#tres-pasos-para-la-realización-del-discriminante-lineal---lda">Tres pasos para la realización del discriminante lineal - LDA</a>
  <ul>
  <li><a href="#paso-1.-pruebas-de-supuestos" id="toc-paso-1.-pruebas-de-supuestos" class="nav-link" data-scroll-target="#paso-1.-pruebas-de-supuestos">Paso 1. Pruebas de supuestos</a>
  <ul class="collapse">
  <li><a href="#supuesto-de-normalidad" id="toc-supuesto-de-normalidad" class="nav-link" data-scroll-target="#supuesto-de-normalidad">1.1 Supuesto de normalidad</a></li>
  <li><a href="#supuesto-de-homogeneidad-de-covarianzas" id="toc-supuesto-de-homogeneidad-de-covarianzas" class="nav-link" data-scroll-target="#supuesto-de-homogeneidad-de-covarianzas">1.2 Supuesto de homogeneidad de covarianzas</a></li>
  </ul></li>
  <li><a href="#paso-2.-análisis-discriminante-lineal-de-fisher---lda" id="toc-paso-2.-análisis-discriminante-lineal-de-fisher---lda" class="nav-link" data-scroll-target="#paso-2.-análisis-discriminante-lineal-de-fisher---lda">Paso 2. Análisis Discriminante Lineal de Fisher - LDA</a></li>
  <li><a href="#paso-3.-visualización-grafica-del-lda" id="toc-paso-3.-visualización-grafica-del-lda" class="nav-link" data-scroll-target="#paso-3.-visualización-grafica-del-lda">Paso 3. Visualización grafica del LDA</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Taller 11.2 Análisis Discriminante Lineal - LDA</h1>
<p class="subtitle lead">Datos de morfométricos de colibríes del pacifico nariñence</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Autor/a</div>
    <div class="quarto-title-meta-contents">
             <p>Javier Rodríguez Barrios </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Fecha de publicación</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 5, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b><section id="análisis-discriminante-lineal---lda---base-colibríes" class="level1"><b style="color:#1f78b4;">
<h1>Análisis Discriminante Lineal - LDA - base <em>colibríes</em></h1>
</b><p><b style="color:#1f78b4;"></b></p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
<p><strong>Objetivo de la actividad:</strong></p>
</b><p><b style="color:#1f78b4;"></b></p>
<p>La base de datos que se utilizará es la de medidas morfométricas de aves en tres tipos de dieta de aves del pacífico nariñense en Colombia (frugívoros, nectarívoros e insectívoros).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://t3.ftcdn.net/jpg/05/61/43/20/240_F_561432029_TFlvDcmtOJ2KOJFjbLJKlCmKlWHi4dJ3.jpg" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption class="figure-caption"><n style="color:#1f78b4;"> Imágen tomada de <em><a href="https://as1.ftcdn.net/v2/jpg/05/61/43/20/1000_F_561432029_TFlvDcmtOJ2KOJFjbLJKlCmKlWHi4dJ3.jpg">Katynn</a></em> </n></figcaption><p></p>
</figure>
</div>
<p>El <strong>objetivo</strong> de este ejercicio consiste en evaluar la membresía de cada individuo a su grupo asignado (tipo de dieta) y de igual forma, probar el modelo lineal realizado, para verificar la membresía o discriminar a nuevos individuos en lo que se requiere saber en qué tipo de dieta pueden clasificar. La base de datos que se utilizará es <strong>Aves.csv</strong>.</p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b><section id="referencias-bibliográficas-de-apoyo." class="level2"><b style="color:#1f78b4;">
<h2 class="anchored" data-anchor-id="referencias-bibliográficas-de-apoyo.">Referencias bibliográficas de apoyo.</h2>
</b><p><b style="color:#1f78b4;"></b></p>
<p><a href="https://github.com/Javier-2712/Libro_andea">Libro: Repositorio de archivos y del “Análisis de datos ecológicos y ambientales” - Rodríguez-Barrios Javier (2022)</a> Ver el capítulo de este libro <a href="https://www-ebooks7-24-com.biblioteca.unimagdalena.edu.co/?il=26489&amp;pg=263">7.3 Análisis discriminante LDA</a> en donde se detallan los procedimientos descritos en el presente ejercicio.</p>
<p><a href="https://www.redalyc.org/articulo.oa?id=180343692007">Sigatoka en cultivos de banano - Aguirre et al.&nbsp;(2015)</a>. Análisis de discriminante canónico y algunas técnicas multivariadas complementarias.</p>
<p><a href="https://www.r-bloggers.com/2021/05/linear-discriminant-analysis-in-r/">Linear Discriminant Analysis in R</a> Se brinda información sobre las generalidades de los lda y su aplicación en R.</p>
<p><a href="https://www.r-bloggers.com/2014/01/computing-and-visualizing-lda-in-r/">Computing and visualizing LDA in R</a> En este documento se brinda información sobre el análisis y la visualización gráfica del lda.</p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b><section id="cargar-las-librerías-requeridas" class="level3"><b style="color:#1f78b4;">
<h3 class="anchored" data-anchor-id="cargar-las-librerías-requeridas">Cargar las librerías requeridas</h3>
</b><p><b style="color:#1f78b4;"></b></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Librerías requeridas</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggforce)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ade4)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vegan)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(candisc)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvnormtest)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="cargar-o-importar-la-base-de-datos" class="level3"><b style="color:#1f78b4;">
<h3 class="anchored" data-anchor-id="cargar-o-importar-la-base-de-datos">Cargar o importar la base de datos</h3>
</b><p><b style="color:#1f78b4;"></b></p>
<p>La presente base de datos se encuentra en formato plano de <code>csv</code>, presenta una columna <code>Dieta</code> que agrupa a las 5 dietas de aves, otra columna <code>Grupo</code>, que asigna un número a cada dieta y posteriormente a las 19 variables morfométricas y 10 variables meristicas, de las cuales se selecionarán las 19 morfométricas para este ejercicio <code>M.1</code> a <code>M.19</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Base de datos</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>aves<span class="ot">&lt;-</span><span class="fu">read.csv2</span>(<span class="st">"Aves.csv"</span>,<span class="at">row.names=</span><span class="dv">1</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(aves)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "FAMILIA"         "GENERO"          "ESPECIE"         "Dieta"          
 [5] "Dieta.n"         "Culmen.Expuesto" "Culmen.Total"    "Largo.Narina"   
 [9] "Alto.Narina"     "Comisura"        "Longitud.Tarzo"  "Cuerda.Alar"    
[13] "Largo.Rectrices" "Longitud.total" </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos sin columnas taxonómicas</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>aves <span class="ot">=</span> aves[,<span class="sc">-</span><span class="dv">5</span>]    <span class="co"># Eliminar la variable cualitativa "Dieta.n"</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>aves <span class="ot">=</span> aves[,<span class="dv">4</span><span class="sc">:</span><span class="dv">13</span>]  <span class="co"># Base de aves, solo con la variables cuantitativas</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir "Dieta" a factor</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>aves<span class="sc">$</span>Dieta <span class="ot">=</span> <span class="fu">as.factor</span>(aves<span class="sc">$</span>Dieta)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(aves)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   82 obs. of  10 variables:
 $ Dieta          : Factor w/ 3 levels "F","I","N": 1 1 1 1 1 1 1 1 1 1 ...
 $ Culmen.Expuesto: num  13.4 7.1 7.8 17.5 13.5 ...
 $ Culmen.Total   : num  15.7 10.2 11.2 22 17.4 ...
 $ Largo.Narina   : num  11.4 5.1 5.7 13.9 10.8 92 16.5 10.3 14.4 7.8 ...
 $ Alto.Narina    : num  6.2 2.7 4.1 9.2 13.4 33.5 14.2 5.6 9.4 3.6 ...
 $ Comisura       : num  10.4 5.9 6.8 7.7 13.1 31.1 18.6 11.9 11.4 7.8 ...
 $ Longitud.Tarzo : num  19.5 16 13 24.2 16.5 35.2 30.1 23.7 25.4 14 ...
 $ Cuerda.Alar    : num  79.8 50.7 58.3 86.1 120.7 ...
 $ Largo.Rectrices: num  68.8 20.7 38.7 76.7 105.9 ...
 $ Longitud.total : num  123.8 67.4 85.6 149.5 201.2 ...</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumir nombres de las variables</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(aves) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Dieta"</span>, <span class="st">"C.exp"</span>, <span class="st">"C.tot"</span>, <span class="st">"L.nar"</span>, <span class="st">"A.nar"</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Com"</span>, <span class="st">"L.tar"</span>, <span class="st">"C.al"</span>, <span class="st">"L.rec"</span>, <span class="st">"L.tot"</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(aves)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   82 obs. of  10 variables:
 $ Dieta: Factor w/ 3 levels "F","I","N": 1 1 1 1 1 1 1 1 1 1 ...
 $ C.exp: num  13.4 7.1 7.8 17.5 13.5 ...
 $ C.tot: num  15.7 10.2 11.2 22 17.4 ...
 $ L.nar: num  11.4 5.1 5.7 13.9 10.8 92 16.5 10.3 14.4 7.8 ...
 $ A.nar: num  6.2 2.7 4.1 9.2 13.4 33.5 14.2 5.6 9.4 3.6 ...
 $ Com  : num  10.4 5.9 6.8 7.7 13.1 31.1 18.6 11.9 11.4 7.8 ...
 $ L.tar: num  19.5 16 13 24.2 16.5 35.2 30.1 23.7 25.4 14 ...
 $ C.al : num  79.8 50.7 58.3 86.1 120.7 ...
 $ L.rec: num  68.8 20.7 38.7 76.7 105.9 ...
 $ L.tot: num  123.8 67.4 85.6 149.5 201.2 ...</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos por cada grupo o tipo de dieta</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(aves[,<span class="dv">1</span>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> F  I  N 
22 49 11 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformación logaritmica de "aves"</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>aves1 <span class="ot">=</span> <span class="fu">log10</span>(aves[,<span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>])</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>aves <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Dieta=</span>aves<span class="sc">$</span>Dieta, aves1)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(aves)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   82 obs. of  10 variables:
 $ Dieta: Factor w/ 3 levels "F","I","N": 1 1 1 1 1 1 1 1 1 1 ...
 $ C.exp: num  1.127 0.851 0.892 1.243 1.13 ...
 $ C.tot: num  1.2 1.01 1.05 1.34 1.24 ...
 $ L.nar: num  1.057 0.708 0.756 1.143 1.033 ...
 $ A.nar: num  0.792 0.431 0.613 0.964 1.127 ...
 $ Com  : num  1.017 0.771 0.833 0.886 1.117 ...
 $ L.tar: num  1.29 1.2 1.11 1.38 1.22 ...
 $ C.al : num  1.9 1.71 1.77 1.94 2.08 ...
 $ L.rec: num  1.84 1.32 1.59 1.88 2.02 ...
 $ L.tot: num  2.09 1.83 1.93 2.17 2.3 ...</code></pre>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="exploración-de-los-datos" class="level3"><b style="color:#1f78b4;">
<h3 class="anchored" data-anchor-id="exploración-de-los-datos">Exploración de los datos</h3>
</b><p><b style="color:#1f78b4;"></b></p>
<p>Para este ejemplo se urtilizarán figuras que relacionan parejas de variables y figuras de cajas que permitan visualizar diferencias entre las dietas de aves de acuerdo a su morfometría. *Para facilidad del ejercicio se seleccionarán algunas variables morfométricas - <code>aves1</code>, debido a que son las que presentan mejores patrones lineales.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Elipses con colores con variables morfométricas</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>aves1 <span class="ot">&lt;-</span> aves1</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">cor</span>(aves1)            <span class="co"># Matriz de Correlación (M)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La <a href="#fig-figura1">Figura&nbsp;1</a> permite visualizar las relaciones lineales entre todas las parejas de variables, incluyendo a los coeficientes de correlación de Pearson.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(M,  <span class="at">method =</span> <span class="st">"circle"</span>,            <span class="co"># Correlaciones con circulos</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="st">"lower"</span>, <span class="at">insig=</span><span class="st">"blank"</span>,    <span class="co"># Forma del panel</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">order =</span> <span class="st">"AOE"</span>, <span class="at">diag =</span> <span class="cn">FALSE</span>,      <span class="co"># Ordenar por nivel de correlación</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">addCoef.col =</span><span class="st">"black"</span>,             <span class="co"># Color de los coeficientes</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">number.cex =</span> <span class="fl">0.6</span>,                 <span class="co"># Tamaño del texto</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">COL2</span>(<span class="st">"RdYlBu"</span>, <span class="dv">200</span>))        <span class="co"># Transparencia de los circulos</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller11.2.lda.colibríes_files/figure-html/fig-figura1-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;1: Correlaciones y coeficientes de correlación.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>La <a href="#fig-figura2">Figura&nbsp;2</a> a diferencia de la anterior, clasifica a los grupos por colores y además incluye a sus coeficientes de correlación y el patrón de distribución de cada variable mediante histogramas de densidad.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span> ((aves1),<span class="at">panel=</span><span class="cf">function</span>(x,y)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>{<span class="fu">abline</span>(<span class="fu">lsfit</span>(x,y)<span class="sc">$</span>coef,<span class="at">lwd=</span><span class="dv">1</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">lowess</span>(x,y),<span class="at">lty=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">1</span>,<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(x,y,<span class="at">col=</span>aves<span class="sc">$</span>Dieta, <span class="at">cex=</span><span class="fl">1.4</span>,<span class="at">pch=</span><span class="dv">19</span>,<span class="at">lwd=</span><span class="fl">0.3</span>)})</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller11.2.lda.colibríes_files/figure-html/fig-figura2-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;2: Relación entre parejas de variables, por cada grupo en comparación (colores).</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>La <a href="#fig-figura3">Figura&nbsp;3</a> permite visualizar la resolución de cada variable para diferenciar o discriminar a las diferentes dietas de aves. Esta figura sirve de insumo para descartar aquellas variables con poco potencial de discriminación de las dietas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figuras multivariadas de Cajas y bigotes</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">melt</span>(aves[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>)]), <span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>value)) <span class="sc">+</span> </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill=</span>Dieta)) <span class="sc">+</span> </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'#fc8d59'</span>,<span class="st">'#ffffbf'</span>,<span class="st">'#99d594'</span>,<span class="st">'#377eb8'</span>,<span class="st">'#33a02c'</span>)) <span class="sc">+</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">""</span>,<span class="at">y=</span><span class="st">"Morfometría"</span>) <span class="sc">+</span> </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> variable,<span class="at">scales=</span><span class="st">"free"</span>) <span class="sc">+</span> </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller11.2.lda.colibríes_files/figure-html/fig-figura3-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;3: Variación en la morfometría de los aves, de acuerdo a cada una de las variables seleccionadas.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b><section id="mapa-de-calor" class="level4"><b style="color:#1f78b4;">
<h4 class="anchored" data-anchor-id="mapa-de-calor">Mapa de Calor</h4>
</b><p><b style="color:#1f78b4;"></b></p>
<p>El siguiente mapa de calor también permite visualizar a la resolución de las variables morfométricas para diferenciar a las dietas de aves, las cuales representan a los grupos en comparación. Con los siguientes comandos se calculará una tabla que resume a los <code>promedios</code> de las 10 variables morfométricas para cada dieta evaluada.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracción de los promedios de las variables para cada Dieta</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>promedios <span class="ot">&lt;-</span> aves <span class="sc">%&gt;%</span>      </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="st">"Dieta"</span>,<span class="st">"C.exp"</span>,<span class="st">"C.tot"</span>,<span class="st">"L.nar"</span>,<span class="st">"A.nar"</span>,<span class="st">"Com"</span>,<span class="st">"L.tar"</span>,<span class="st">"C.al"</span>,<span class="st">"L.rec"</span>,<span class="st">"L.tot"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Dieta) <span class="sc">%&gt;%</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), mean))</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>promedios  <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(promedios) <span class="co"># Guardar promedios como dataframe</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co"># promedios</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A continuación se comvierte el dataframe a formato matricial - <code>promedios2</code>, para poder ser graficado en el mapa de calor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Seleccionar columnas de 2 a 10 del data frame aves1 y convertirlas en matriz</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>promedios2 <span class="ot">&lt;-</span> promedios <span class="sc">%&gt;%</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>              <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">as.matrix</span>()</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(promedios2,<span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  C.exp C.tot L.nar A.nar  Com L.tar C.al L.rec L.tot
1  1.16  1.25  1.04  0.81 0.99  1.30 1.90  1.81  2.11
2  1.15  1.24  1.03  0.64 0.95  1.32 1.85  1.72  2.05
3  1.37  1.45  1.33  0.35 0.58  0.76 1.76  1.71  1.91</code></pre>
</div>
</div>
<p>Ahora se incluyen los nombres de las dietas a la matriz <code>promedios2</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Asignar los valores de la primera columna de aves1 como nombres de fila en la matriz aves2</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(promedios2) <span class="ot">&lt;-</span> promedios[,<span class="dv">1</span>]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La <a href="#fig-figura4">Figura&nbsp;4</a> permite visualizar a las variables que mejor discriminan a las dietas de aves (variables de tonalidad rojiza).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figura del primer mapa de calor</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>hv <span class="ot">&lt;-</span> <span class="fu">heatmap</span>(promedios2, </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">margins=</span><span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">12</span>), </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">distfun =</span> dist,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">xlab =</span><span class="st">"Variables morfométricas"</span>, </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">ylab=</span> <span class="st">"Dieta de aves"</span>, </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">main =</span> <span class="st">"Clasificación de aves"</span>) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller11.2.lda.colibríes_files/figure-html/fig-figura4-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;4: Mapa de calor que relaciona a las variables morfométricas y a las dietas de aves.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>La <a href="#fig-figura5">Figura&nbsp;5</a> incorpora elementos adicionales como al método de agrupamiento <code>upgma</code>, asumiendo que puede ser el que mejor se ajusta a los datos de este ejercicio.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Opción 2. Mapa de calor con paquete "stats"</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>hclust.fq <span class="ot">&lt;-</span> <span class="cf">function</span>(promedios2) </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>             <span class="fu">hclust</span>(promedios2, <span class="at">method=</span><span class="st">"average"</span>)   <span class="co"># Inserción de UPGMA</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"gplots"</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap.2</span>(promedios2,         <span class="co"># Base de datos en formato matricial</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">margins=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">8</span>),    <span class="co"># Margenes de la figura</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">scale =</span> <span class="st">"row"</span>,      <span class="co"># Estandariza variables diferentes.</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="fu">bluered</span>(<span class="dv">100</span>),                 <span class="co"># Colores del mapa de calor</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span><span class="st">"Variables morfométricas"</span>, </span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab=</span> <span class="st">"Dieta de aves"</span>, </span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Clasificación de aves"</span>,   </span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">trace =</span> <span class="st">"none"</span>, </span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">density.info =</span> <span class="st">"none"</span>,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">distfun =</span> dist,          <span class="co"># Se puede usar vegdist de "vegan" </span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">hclustfun=</span>hclust.fq)     <span class="co"># Agrupamiento UPGMA</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura5" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller11.2.lda.colibríes_files/figure-html/fig-figura5-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;5: Mapa de calor que relaciona a las variables morfométricas y a las dietas de aves.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="tres-pasos-para-la-realización-del-discriminante-lineal---lda" class="level1"><b style="color:#1f78b4;">
<h1>Tres pasos para la realización del discriminante lineal - LDA</h1>
</b><p><b style="color:#1f78b4;"></b></p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b><section id="paso-1.-pruebas-de-supuestos" class="level2"><b style="color:#1f78b4;">
<h2 class="anchored" data-anchor-id="paso-1.-pruebas-de-supuestos">Paso 1. Pruebas de supuestos</h2>
</b><p><b style="color:#1f78b4;"></b></p>
<p>Para que el análisis discriminante lineal sea considerado como un modelo lineal, debe cumplir con los supuestos de normalidad multivariada y de homogeneidad de covarianzas. Para el caso del presente ejercicio, dichos supuestos no alcanzan a cumplirse con los diagnosticos utilizados (valor p &gt; 0.05), motivo por el cual, el lda de este ejercicio será tomado como una técnica de exploración moltivariada para saber que tan bien discriminados quedan los individuos de cada dieta, basado en las 9 variables morfométricas seleccionadas.</p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b><section id="supuesto-de-normalidad" class="level3"><b style="color:#1f78b4;">
<h3 class="anchored" data-anchor-id="supuesto-de-normalidad">1.1 Supuesto de normalidad</h3>
</b><p><b style="color:#1f78b4;"></b></p>
<p>El supuesto de normalidad multivariada será evaluado con el paquete <code>mvnormtest</code>, el cual utiliza el estadìstico de <code>Shapiro Wilks Multivariado</code>. Para ello se realizará esta prueba en cada uno de los grupos o dietas en comparación.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnóstico de normalidad por cada tipo de Dieta</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvnormtest)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Los siguientes generan los dataframes de cada dieta con las 9 variables seleccionadas, convirtiendola además en formato matricial.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dataframe por cada dieta</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(aves)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Dieta      C.exp            C.tot            L.nar            A.nar       
 F:22   Min.   :0.8195   Min.   :0.9685   Min.   :0.7076   Min.   :0.2304  
 I:49   1st Qu.:1.0540   1st Qu.:1.1576   1st Qu.:0.9420   1st Qu.:0.5051  
 N:11   Median :1.1553   Median :1.2529   Median :1.0453   Median :0.6074  
        Mean   :1.1816   Mean   :1.2721   Mean   :1.0711   Mean   :0.6446  
        3rd Qu.:1.3010   3rd Qu.:1.3483   3rd Qu.:1.1584   3rd Qu.:0.7596  
        Max.   :2.0577   Max.   :2.0577   Max.   :1.9638   Max.   :1.5250  
      Com             L.tar             C.al           L.rec      
 Min.   :0.3802   Min.   :0.4914   Min.   :1.483   Min.   :0.959  
 1st Qu.:0.8277   1st Qu.:1.2082   1st Qu.:1.767   1st Qu.:1.644  
 Median :0.8921   Median :1.2933   Median :1.816   Median :1.733  
 Mean   :0.9110   Mean   :1.2398   Mean   :1.851   Mean   :1.744  
 3rd Qu.:1.0324   3rd Qu.:1.3816   3rd Qu.:1.932   3rd Qu.:1.839  
 Max.   :1.4928   Max.   :1.8657   Max.   :2.290   Max.   :2.293  
     L.tot      
 Min.   :1.581  
 1st Qu.:1.929  
 Median :2.024  
 Mean   :2.046  
 3rd Qu.:2.155  
 Max.   :2.480  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># datos de F.</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>Dieta.f   <span class="ot">&lt;-</span> aves <span class="sc">%&gt;%</span> </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(Dieta <span class="sc">==</span> <span class="st">"F"</span>) <span class="sc">%&gt;%</span>       </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>             <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="st">"C.exp"</span>,<span class="st">"C.tot"</span>,<span class="st">"L.nar"</span>,<span class="st">"A.nar"</span>,<span class="st">"Com"</span>,<span class="st">"L.tar"</span>,<span class="st">"C.al"</span>,<span class="st">"L.rec"</span>,<span class="st">"L.tot"</span>)) <span class="sc">%&gt;%</span>              <span class="fu">as.matrix</span>()</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co"># datos de I.</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>Dieta.i  <span class="ot">&lt;-</span> aves <span class="sc">%&gt;%</span> </span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(Dieta <span class="sc">==</span> <span class="st">"I"</span>) <span class="sc">%&gt;%</span>       </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>             <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="st">"C.exp"</span>,<span class="st">"C.tot"</span>,<span class="st">"L.nar"</span>,<span class="st">"A.nar"</span>,<span class="st">"Com"</span>,<span class="st">"L.tar"</span>,<span class="st">"C.al"</span>,<span class="st">"L.rec"</span>,<span class="st">"L.tot"</span>)) <span class="sc">%&gt;%</span>              <span class="fu">as.matrix</span>() </span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="co"># datos de N.</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>Dieta.n <span class="ot">&lt;-</span> aves <span class="sc">%&gt;%</span> </span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(Dieta <span class="sc">==</span> <span class="st">"N"</span>) <span class="sc">%&gt;%</span>       </span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>             <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="st">"C.exp"</span>,<span class="st">"C.tot"</span>,<span class="st">"L.nar"</span>,<span class="st">"A.nar"</span>,<span class="st">"Com"</span>,<span class="st">"L.tar"</span>,<span class="st">"C.al"</span>,<span class="st">"L.rec"</span>,<span class="st">"L.tot"</span>)) <span class="sc">%&gt;%</span>              <span class="fu">as.matrix</span>()     </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Cálculo de los diagnósticos de normalidad multivariada de cada grupo de dietas de las aves.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prueba de normalidad para cada Dieta</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>norm1 <span class="ot">&lt;-</span> <span class="fu">mshapiro.test</span>(<span class="fu">t</span>(Dieta.f)) </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>norm2 <span class="ot">&lt;-</span> <span class="fu">mshapiro.test</span>(<span class="fu">t</span>(Dieta.i))</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>norm3 <span class="ot">&lt;-</span> <span class="fu">mshapiro.test</span>(<span class="fu">t</span>(Dieta.n)) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A continuación se resume el resultado de los tres diagnósticos de normalidad multivariada realizados. Vale la pena mencionar que ninguna dieta cumple con dicho supuesto estadístico (valores p &lt; 0.05), aunque existe la posibilidad de probar con alguna transformación.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen de el diagnóstico de normalidad</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>((<span class="at">normalidad =</span> <span class="fu">data.frame</span>(<span class="at">Norm.Dieta.f =</span> norm1<span class="sc">$</span>p.value,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Norm.Dieta.i =</span> norm2<span class="sc">$</span>p.value,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Norm.Dieta.n =</span> norm3<span class="sc">$</span>p.value)),<span class="dv">12</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Norm.Dieta.f Norm.Dieta.i Norm.Dieta.n
1  1.64986e-07        3e-12   2.5872e-08</code></pre>
</div>
</div>
<p><strong>Tarea:</strong> Probar este diagnóstico con la base “aves1”</p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="supuesto-de-homogeneidad-de-covarianzas" class="level3"><b style="color:#1f78b4;">
<h3 class="anchored" data-anchor-id="supuesto-de-homogeneidad-de-covarianzas">1.2 Supuesto de homogeneidad de covarianzas</h3>
</b><p><b style="color:#1f78b4;"></b></p>
<p>La prueba de homogeneidad de covarianza o <strong>esfericidad</strong>, corresponde al segundo supuesto del análisis discriminante lineal, se utilizará la función <code>betadisper</code>, la cual es complementada por dos análisis de varianza, los cuales definirán si el supuesto logra ser cumplido.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pruebas de Homogeneidad de covarianzas paquete "vegan"</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>aves.d <span class="ot">&lt;-</span> <span class="fu">dist</span>(aves[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>)])              <span class="co"># Matriz de distancias</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>aves.homoge <span class="ot">&lt;-</span> <span class="fu">betadisper</span>(aves.d, aves<span class="sc">$</span>Dieta)   <span class="co"># Permutest</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Con la siguiente <code>anova</code> se obtiene un valor p de 0.56*, lo cual indica que SI se cumple el supuesto de homogeneidad de covarianzas (valor p &lt; 0.05).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Prueba con anova permutacional</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(aves.homoge)  </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Distances
          Df Sum Sq  Mean Sq F value Pr(&gt;F)
Groups     2 0.0885 0.044226  0.5726 0.5664
Residuals 79 6.1012 0.077231               </code></pre>
</div>
</div>
<p>Con el <code>permutest</code> se obtiene un valor p de 0.56*, lo cual indica que SI se cumple el supuesto de homogeneidad de covarianzas (valor p &lt; 0.05).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Prueba permutacional</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(aves.homoge)   <span class="co"># Se cumple el supuesto de homogeneidad </span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 999

Response: Distances
          Df Sum Sq  Mean Sq      F N.Perm Pr(&gt;F)
Groups     2 0.0885 0.044226 0.5726    999   0.58
Residuals 79 6.1012 0.077231                     </code></pre>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="paso-2.-análisis-discriminante-lineal-de-fisher---lda" class="level2"><b style="color:#1f78b4;">
<h2 class="anchored" data-anchor-id="paso-2.-análisis-discriminante-lineal-de-fisher---lda">Paso 2. Análisis Discriminante Lineal de Fisher - LDA</h2>
</b><p><b style="color:#1f78b4;"></b></p>
<p>A continuación, se realizará el lda, que permitirá generar definir al nivel de discriminación de cada grupo o dieta de colibríes. Se presentan algunas opciones gráficas con el procedimiento general y con el análisis discriminate canónico (dca)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cálculo del LDA</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(aves)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Dieta" "C.exp" "C.tot" "L.nar" "A.nar" "Com"   "L.tar" "C.al"  "L.rec"
[10] "L.tot"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>dis<span class="ot">&lt;-</span><span class="fu">lda</span> (Dieta <span class="sc">~</span> C.exp<span class="sc">+</span>C.tot<span class="sc">+</span>L.nar<span class="sc">+</span>A.nar<span class="sc">+</span>Com<span class="sc">+</span>L.tar<span class="sc">+</span>C.al<span class="sc">+</span>L.rec<span class="sc">+</span>L.tot,</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> aves)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(dis<span class="sc">$</span>prior,<span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   F    I    N 
0.27 0.60 0.13 </code></pre>
</div>
</div>
<p>“<em>Prior probabilities of groups</em>” corresponde a la probabilidad de clasificación para cada grupo que dependerá del número de aves que lo conforman, aquellas dietas con mayor número de individuos censados, presentarán mayor probabilidad de discriminación.</p>
<p>Prbabilidad de clasificar indv. de los cinco grupos: F I N<br>
0.27 0.60 0.13</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Insumos del AD </span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(dis)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A continuación se presentan los promedios de cada dieta por cada variable morfométrica seleccionada para el análisis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Grupos de medias para las 4 variables </span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(dis<span class="sc">$</span>means,<span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  C.exp C.tot L.nar A.nar  Com L.tar C.al L.rec L.tot
F  1.16  1.25  1.04  0.81 0.99  1.30 1.90  1.81  2.11
I  1.15  1.24  1.03  0.64 0.95  1.32 1.85  1.72  2.05
N  1.37  1.45  1.33  0.35 0.58  0.76 1.76  1.71  1.91</code></pre>
</div>
</div>
<p>Los autovalores son los que permiten definir las coordenadas de las variables para cada función canónica (eje o dimensión del lda), para la grafica del discriminante, se utilizarán las funciones <code>LD1</code> y <code>LD2</code>, como ejes <code>x</code> y <code>y</code> respectivamente (ver <span class="citation" data-cites="fi-figura6">@fi-figura6</span>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Autovalores estandarizados (pesos de las variables en cada eje)</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>((Cs <span class="ot">&lt;-</span> dis<span class="sc">$</span>scaling),<span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        LD1   LD2
C.exp  1.11  0.31
C.tot  5.41 -0.76
L.nar  0.75 -1.33
A.nar -0.93  8.06
Com   -7.20 -4.25
L.tar -5.52 -2.68
C.al   3.82  0.94
L.rec  0.46  1.96
L.tot -1.16 -1.93</code></pre>
</div>
</div>
<p>En el siguiente insumo se relacionan las coordenadas de las 6 primeras observaciones, las cuales también serán graficadas en la <span class="citation" data-cites="fi-figura6">@fi-figura6</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coordenadas de las seis primeras observaciones en cada eje canónico</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">head</span>(Fp <span class="ot">&lt;-</span> <span class="fu">predict</span>(dis)<span class="sc">$</span>x),<span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     LD1   LD2
3  -1.48  0.81
13 -1.17 -1.00
14 -0.74  0.75
20 -0.18  2.27
31 -1.36  3.40
32  0.22  2.71</code></pre>
</div>
</div>
<p>La siguiente tabla es conocida como <strong>tabla de contingencia</strong> la cual realiza una validación cruzada entre las dietas (filas) y los grupos discriminados por el lda (columnas). De acuerdo a esta tabla <em>F</em> e <em>I</em> no discriminan a todos sus individuos en su grupo, debido a que hay individuos de estas aves que presentan una morfometría más similar a otros grupos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluación de desempeño del AD (método 1)</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(aves)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>group<span class="ot">&lt;-</span><span class="fu">predict</span>(dis,<span class="at">method=</span><span class="st">"plug-in"</span>)<span class="sc">$</span>class</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>(tabla<span class="ot">&lt;-</span><span class="fu">table</span>(Dieta,group))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     group
Dieta  F  I  N
    F 12 10  0
    I  6 43  0
    N  0  0 11</code></pre>
</div>
</div>
<p>La siguiente tabla realiza una validación en términos porcentuales, definiendo que en los casos de <em>F</em> e <em>I</em> donde el 55% y el 88% de sus individuos discriminan correctamente en su dieta. La dieta N presenta una discriminación completa en su grupo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Porcentaje de clasificación correcta </span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">diag</span>(<span class="fu">prop.table</span>(tabla, <span class="dv">1</span>)),<span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  F   I   N 
 55  88 100 </code></pre>
</div>
</div>
<p>La siguiente validación realizada por el método de Jacknife, presenta menos resolución de discriminación que la anterior, por lo cual no será tenida en cuenta en este ejercicio.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># M?todo 2: con clasifiación basada en jacknife (validación cruzada dejando uno afuera)</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>dis.jac <span class="ot">&lt;-</span> <span class="fu">lda</span>(Dieta <span class="sc">~</span> C.exp<span class="sc">+</span>C.tot<span class="sc">+</span>L.nar<span class="sc">+</span>A.nar<span class="sc">+</span>Com<span class="sc">+</span>L.tar<span class="sc">+</span>C.al<span class="sc">+</span>L.rec<span class="sc">+</span>L.tot,</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">data=</span>aves, <span class="at">CV=</span><span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Número y proporciones de clasificación correcta</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>clases.jac <span class="ot">&lt;-</span> dis.jac<span class="sc">$</span>class</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>tabla.jac <span class="ot">&lt;-</span> <span class="fu">table</span>(Dieta, clases.jac)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>tabla.jac</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     clases.jac
Dieta  F  I  N
    F 10 12  0
    I  9 39  1
    N  0  0 11</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Validación cruzada</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">diag</span>(<span class="fu">prop.table</span>(tabla.jac, <span class="dv">1</span>)),<span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  F   I   N 
 45  80 100 </code></pre>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="paso-3.-visualización-grafica-del-lda" class="level2"><b style="color:#1f78b4;">
<h2 class="anchored" data-anchor-id="paso-3.-visualización-grafica-del-lda">Paso 3. Visualización grafica del LDA</h2>
<ul>
<li>** 3.1 Gráfico de elipses.**</li>
</ul>
</b><p><b style="color:#1f78b4;"></b></p>
<p>A continuación se realizará el componente grafico del lda, el cual inicia con una figura que definirá unas elipses, las cuales relacionan a los individuos de cada dieta y cuyo solapamiento definirá el nivel de relación entre estas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Escores o coordenadas de las observaciones en cada eje can?nico</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>Fp <span class="ot">&lt;-</span> <span class="fu">predict</span>(dis)<span class="sc">$</span>x</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Grupos asignados por el AD</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>group<span class="ot">&lt;-</span><span class="fu">predict</span>(dis,<span class="at">method=</span><span class="st">"plug-in"</span>)<span class="sc">$</span>class</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coordenadas y grupos asignados</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>aves.coord<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">Dieta=</span>group,Fp)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La <a href="#fig-figura6">Figura&nbsp;6</a> demuestra que si bien de presenta una buena discriminación de las dietas de aves, 2 de las 3 evaluadas presentan cierta relación, definida por el solapamiento de sus elipses.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figura del LDA</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(aves)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="fu">scatterplot</span>(LD2<span class="sc">~</span>LD1 <span class="sc">|</span> Dieta, <span class="at">data=</span>aves.coord,<span class="at">reg.line=</span><span class="cn">FALSE</span>, </span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">smooth=</span>F, <span class="at">spread=</span>F,<span class="at">span=</span> <span class="dv">1</span>,<span class="at">grid=</span>F,</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend=</span><span class="fu">list</span>(<span class="at">coords=</span><span class="st">"bottom"</span>), </span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">ellipse=</span>T,<span class="at">font.lab=</span><span class="dv">2</span>, <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">16</span>,<span class="dv">17</span>,<span class="dv">18</span>,<span class="dv">19</span>),</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">col=</span><span class="fu">c</span>(<span class="st">'#33a02c'</span>,<span class="st">'#e41a1c'</span>,<span class="st">'#984ea3'</span>),</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">main=</span><span class="st">"Análisis discriminante"</span>,</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">font.main=</span><span class="dv">2</span>,<span class="at">cex.main=</span><span class="dv">2</span>,<span class="at">cex.lab=</span><span class="fl">1.5</span>,</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">xlab=</span><span class="st">"Eje1"</span>, <span class="at">ylab=</span><span class="st">"Eje2"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura6" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller11.2.lda.colibríes_files/figure-html/fig-figura6-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;6: Mapa de calor que relaciona a las variables morfométricas y a las dietas de aves.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
<ul>
<li>** 3.2 Gráfico del discriminante canónico - cda**</li>
</ul>
</b><p><b style="color:#1f78b4;"></b></p>
<p>El siguiente análisis permite visualizar la influencia de cada variable morfométrica en la separación de los grupos de dietas y selecciona a las variables que presentan más influencia en la discriminación de esos grupos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(aves)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(aves)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Dieta" "C.exp" "C.tot" "L.nar" "A.nar" "Com"   "L.tar" "C.al"  "L.rec"
[10] "L.tot"</code></pre>
</div>
</div>
<p>Lo primero que se realiza es el modelo lineal <code>mod</code> indicando las variables y los grupos a discriminar.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo Lineal multivariado con las variables morfom?tricas de aves</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">cbind</span>(C.exp,C.tot,L.nar,A.nar,Com,L.tar,C.al,L.rec,L.tot) <span class="sc">~</span> Dieta, aves)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen del modelo multivariado</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mod)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Posteriormente realiza el discriminante canónico <code>can</code> que permite realizar la discriminación de los grupos en los ejes canónicos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Análisis discriminante canónico - ADC</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>can <span class="ot">&lt;-</span> <span class="fu">candisc</span>(mod, <span class="at">term=</span><span class="st">"Dieta"</span>,<span class="at">data=</span>aves,<span class="at">ndim=</span><span class="dv">1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A continuación se presenta la figura que define a la discriminación de las dietas con un solo eje canónico el cual explica el 95% de la variación de los datos. La orientación de los vectores (variables morfométricas), en relación a las cajas, indica su importancia para discriminar a cada dieta o grupo en comparación.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(can,<span class="at">titles.1d =</span> <span class="fu">c</span>(<span class="st">"Puntuación canónica"</span>, <span class="st">"Estructura"</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura7" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller11.2.lda.colibríes_files/figure-html/fig-figura7-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;7: Discriminante de los grupos de dietas con un eje canónico.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>En el siguiente enlace se puede obtener un caso aplicado con este tipo de análisis multivariados: <a href="https://www.redalyc.org/articulo.oa?id=180343692007">Aguirre et al.&nbsp;(2015)</a>. Ver la figura 2 del manuscrito en mención.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script>
</div> <!-- /content -->



</body></html>