<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es-ES" xml:lang="es-ES"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Javier Rodríguez Barrios">
<meta name="dcterms.date" content="2023-05-05">

<title>Taller 11.1 Análisis Discriminante Lineal - LDA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Taller11.1.lda.peces_files/libs/clipboard/clipboard.min.js"></script>
<script src="Taller11.1.lda.peces_files/libs/quarto-html/quarto.js"></script>
<script src="Taller11.1.lda.peces_files/libs/quarto-html/popper.min.js"></script>
<script src="Taller11.1.lda.peces_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Taller11.1.lda.peces_files/libs/quarto-html/anchor.min.js"></script>
<link href="Taller11.1.lda.peces_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Taller11.1.lda.peces_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Taller11.1.lda.peces_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Taller11.1.lda.peces_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Taller11.1.lda.peces_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


<link rel="stylesheet" href="styles.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#análisis-discriminante-lineal---lda---base-peces" id="toc-análisis-discriminante-lineal---lda---base-peces" class="nav-link active" data-scroll-target="#análisis-discriminante-lineal---lda---base-peces">Análisis Discriminante Lineal - LDA - base <em>peces</em></a>
  <ul>
  <li><a href="#referencias-bibliográficas-de-apoyo." id="toc-referencias-bibliográficas-de-apoyo." class="nav-link" data-scroll-target="#referencias-bibliográficas-de-apoyo.">Referencias bibliográficas de apoyo.</a>
  <ul class="collapse">
  <li><a href="#cargar-las-librerías-requeridas" id="toc-cargar-las-librerías-requeridas" class="nav-link" data-scroll-target="#cargar-las-librerías-requeridas">Cargar las librerías requeridas</a></li>
  <li><a href="#cargar-o-importar-la-base-de-datos" id="toc-cargar-o-importar-la-base-de-datos" class="nav-link" data-scroll-target="#cargar-o-importar-la-base-de-datos">Cargar o importar la base de datos</a></li>
  <li><a href="#exploración-de-los-datos" id="toc-exploración-de-los-datos" class="nav-link" data-scroll-target="#exploración-de-los-datos">Exploración de los datos</a>
  <ul class="collapse">
  <li><a href="#mapa-de-calor" id="toc-mapa-de-calor" class="nav-link" data-scroll-target="#mapa-de-calor">Mapa de Calor</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  <li><a href="#tres-pasos-para-la-realización-del-discriminante-lineal---lda" id="toc-tres-pasos-para-la-realización-del-discriminante-lineal---lda" class="nav-link" data-scroll-target="#tres-pasos-para-la-realización-del-discriminante-lineal---lda">Tres pasos para la realización del discriminante lineal - LDA</a>
  <ul>
  <li><a href="#paso-1.-pruebas-de-supuestos" id="toc-paso-1.-pruebas-de-supuestos" class="nav-link" data-scroll-target="#paso-1.-pruebas-de-supuestos">Paso 1. Pruebas de supuestos</a>
  <ul class="collapse">
  <li><a href="#supuesto-de-normalidad" id="toc-supuesto-de-normalidad" class="nav-link" data-scroll-target="#supuesto-de-normalidad">1.1 Supuesto de normalidad</a></li>
  <li><a href="#supuesto-de-homogeneidad-de-covarianzas" id="toc-supuesto-de-homogeneidad-de-covarianzas" class="nav-link" data-scroll-target="#supuesto-de-homogeneidad-de-covarianzas">1.2 Supuesto de homogeneidad de covarianzas</a></li>
  </ul></li>
  <li><a href="#paso-2.-análisis-discriminante-lineal-de-fisher---lda" id="toc-paso-2.-análisis-discriminante-lineal-de-fisher---lda" class="nav-link" data-scroll-target="#paso-2.-análisis-discriminante-lineal-de-fisher---lda">Paso 2. Análisis Discriminante Lineal de Fisher - LDA</a></li>
  <li><a href="#paso-3.-visualización-grafica-del-lda" id="toc-paso-3.-visualización-grafica-del-lda" class="nav-link" data-scroll-target="#paso-3.-visualización-grafica-del-lda">Paso 3. Visualización grafica del LDA</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Taller 11.1 Análisis Discriminante Lineal - LDA</h1>
<p class="subtitle lead">Datos de morfométricos de peces de ríos de la India</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Autor/a</div>
    <div class="quarto-title-meta-contents">
             <p>Javier Rodríguez Barrios </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Fecha de publicación</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 5, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b><section id="análisis-discriminante-lineal---lda---base-peces" class="level1"><b style="color:#1f78b4;">
<h1>Análisis Discriminante Lineal - LDA - base <em>peces</em></h1>
</b><p><b style="color:#1f78b4;"></b></p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
<p><strong>Objetivo de la actividad:</strong></p>
</b><p><b style="color:#1f78b4;"></b></p>
<p>La base de datos que se utilizará es la de medidas morfométricas de peces de un estudio realizado con peces de la india por <strong>Gupta et al.&nbsp;(2018)</strong> <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6203374/">Articulo fuente</a> en los que se validó la taxonomía de peces de la subfamilia Barbinae, utilizando 19 variables morfométricas y 19 variables meristicas, correspondientes a 5 especies de la familia en mención.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6203374/bin/pone.0206031.g002.jpg" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption class="figure-caption"><n style="color:#1f78b4;"> Imágen tomada de <em>Gupta et al.&nbsp;(2018)</em> (a) <em>S . Sarana</em> (b) <em>P . ticto</em> (c) <em>P . sóforo</em> , (d) <em>P . conconio</em> y (e) <em>P . chola</em> </n></figcaption><p></p>
</figure>
</div>
<p>El <strong>objetivo</strong> de este ejercicio consiste en identificar a las variables morfométricas que mejor discriminan a las especies de peces y si dichas especies se encuentran bien discriminadas en sus grupos taxonómicos asignados. De igual forma se construirá un modelo lineal en el que se puedan incluir nuevos individuos tomados de la misma muestra de peces y puedan ser discriminados de manera eficiente. La base de datos que se utilizará es <strong>peces.csv</strong>.</p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b><section id="referencias-bibliográficas-de-apoyo." class="level2"><b style="color:#1f78b4;">
<h2 class="anchored" data-anchor-id="referencias-bibliográficas-de-apoyo.">Referencias bibliográficas de apoyo.</h2>
</b><p><b style="color:#1f78b4;"></b></p>
<p><a href="https://github.com/Javier-2712/Libro_andea">Libro: Repositorio de archivos y del “Análisis de datos ecológicos y ambientales” - Rodríguez-Barrios Javier (2022)</a> Ver el capítulo de este libro <a href="https://www-ebooks7-24-com.biblioteca.unimagdalena.edu.co/?il=26489&amp;pg=263">7.3 Análisis discriminante LDA</a> en donde se detallan los procedimientos que pueden servir de apoyo al presente ejercicio.</p>
<p><a href="https://www.redalyc.org/articulo.oa?id=180343692007">Sigatoka en cultivos de banano - Aguirre et al.&nbsp;(2015)</a>. Análisis de discriminante canónico y algunas técnicas multivariadas complementarias.</p>
<p><a href="https://www.r-bloggers.com/2021/05/linear-discriminant-analysis-in-r/">Linear Discriminant Analysis in R</a> Se brinda información sobre las generalidades de los lda y su aplicación en R.</p>
<p><a href="https://www.r-bloggers.com/2014/01/computing-and-visualizing-lda-in-r/">Computing and visualizing LDA in R</a> En este documento se brinda información sobre el análisis y la visualización gráfica del lda.</p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b><section id="cargar-las-librerías-requeridas" class="level3"><b style="color:#1f78b4;">
<h3 class="anchored" data-anchor-id="cargar-las-librerías-requeridas">Cargar las librerías requeridas</h3>
</b><p><b style="color:#1f78b4;"></b></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Librerías requeridas</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggforce)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ade4)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vegan)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(candisc)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvnormtest)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="cargar-o-importar-la-base-de-datos" class="level3"><b style="color:#1f78b4;">
<h3 class="anchored" data-anchor-id="cargar-o-importar-la-base-de-datos">Cargar o importar la base de datos</h3>
</b><p><b style="color:#1f78b4;"></b></p>
<p>La presente base de datos se encuentra en formato plano de <code>csv</code>, presenta una columna <code>Especie</code> que agrupa a las 5 especies de peces, otra columna <code>Grupo</code>, que asigna un número a cada especie y posteriormente a las 19 variables morfométricas y 10 variables meristicas, de las cuales se selecionarán las 19 morfométricas para este ejercicio <code>M.1</code> a <code>M.19</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Base de datos</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>peces<span class="ot">&lt;-</span><span class="fu">read.csv2</span>(<span class="st">"peces.csv"</span>,<span class="at">row.names=</span><span class="dv">1</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(peces)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Especie" "Grupo"   "M.1"     "M.2"     "M.3"     "M.4"     "M.5"    
 [8] "M.6"     "M.7"     "M.8"     "M.9"     "M.10"    "M.11"    "M.12"   
[15] "M.13"    "M.14"    "M.15"    "M.16"    "M.17"    "M.18"    "M.19"   
[22] "M.20"    "M.21"    "M.22"    "M.23"    "M.24"    "M.25"    "M.26"   
[29] "M.27"    "M.28"    "M.29"   </code></pre>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="exploración-de-los-datos" class="level3"><b style="color:#1f78b4;">
<h3 class="anchored" data-anchor-id="exploración-de-los-datos">Exploración de los datos</h3>
</b><p><b style="color:#1f78b4;"></b></p>
<p>Para este ejemplo se urtilizarán figuras que relacionan parejas de variables y figuras de cajas que permitan visualizar diferencias entre las especies de peces de acuerdo a su morfometría. *Para facilidad del ejercicio se seleccionarán algunas variables morfométricas - <code>peces1</code>, debido a que son las que presentan mejores patrones lineales.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Elipses con colores con variables morfométricas</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>peces1 <span class="ot">&lt;-</span> peces[,<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>,<span class="dv">15</span>,<span class="dv">17</span>,<span class="dv">20</span>)]</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">cor</span>(peces1)            <span class="co"># Matriz de Correlación (M)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La <a href="#fig-figura1">Figura&nbsp;1</a> permite visualizar las relaciones lineales entre todas las parejas de variables, incluyendo a los coeficientes de correlación de Pearson.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(M,  <span class="at">method =</span> <span class="st">"circle"</span>,            <span class="co"># Correlaciones con circulos</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="st">"lower"</span>, <span class="at">insig=</span><span class="st">"blank"</span>,    <span class="co"># Forma del panel</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">order =</span> <span class="st">"AOE"</span>, <span class="at">diag =</span> <span class="cn">FALSE</span>,      <span class="co"># Ordenar por nivel de correlación</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">addCoef.col =</span><span class="st">"black"</span>,             <span class="co"># Color de los coeficientes</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">number.cex =</span> <span class="fl">0.6</span>,                 <span class="co"># Tamaño del texto</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">COL2</span>(<span class="st">"RdYlBu"</span>, <span class="dv">200</span>))        <span class="co"># Transparencia de los circulos</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller11.1.lda.peces_files/figure-html/fig-figura1-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;1: Correlaciones y coeficientes de correlación.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>La <a href="#fig-figura2">Figura&nbsp;2</a> a diferencia de la anterior, clasifica a los grupos por colores y además incluye a sus coeficientes de correlación y el patrón de distribución de cada variable mediante histogramas de densidad.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>peces1 <span class="ot">&lt;-</span> peces[,<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>,<span class="dv">15</span>,<span class="dv">17</span>,<span class="dv">20</span>)]</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>peces<span class="sc">$</span>Especie <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(peces<span class="sc">$</span>Especie)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span> ((peces1),<span class="at">panel=</span><span class="cf">function</span>(x,y)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>{<span class="fu">abline</span>(<span class="fu">lsfit</span>(x,y)<span class="sc">$</span>coef,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">lowess</span>(x,y),<span class="at">lty=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(x,y,<span class="at">col=</span>peces<span class="sc">$</span>Especie, <span class="at">cex=</span><span class="fl">1.4</span>,<span class="at">pch=</span><span class="dv">19</span>,<span class="at">lwd=</span><span class="fl">0.6</span>)})</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller11.1.lda.peces_files/figure-html/fig-figura2-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;2: Relación entre parejas de variables, por cada grupo en comparación (colores).</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>La <a href="#fig-figura3">Figura&nbsp;3</a> permite visualizar la resolución de cada variable para diferenciar o discriminar a las diferentes especies de peces. Esta figura sirve de insumo para descartar aquellas variables con poco potencial de discriminación de las especies.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figuras multivariadas de Cajas y bigotes</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">melt</span>(peces[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>,<span class="dv">15</span>,<span class="dv">17</span>,<span class="dv">20</span>)]), <span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>value)) <span class="sc">+</span> </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill=</span>Especie)) <span class="sc">+</span> </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'#fc8d59'</span>,<span class="st">'#ffffbf'</span>,<span class="st">'#99d594'</span>,<span class="st">'#377eb8'</span>,<span class="st">'#33a02c'</span>)) <span class="sc">+</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">""</span>,<span class="at">y=</span><span class="st">"Morfometría"</span>) <span class="sc">+</span> </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> variable,<span class="at">scales=</span><span class="st">"free"</span>) <span class="sc">+</span> </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller11.1.lda.peces_files/figure-html/fig-figura3-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;3: Variación en la morfometría de los peces, de acuerdo a cada una de las variables seleccionadas.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b><section id="mapa-de-calor" class="level4"><b style="color:#1f78b4;">
<h4 class="anchored" data-anchor-id="mapa-de-calor">Mapa de Calor</h4>
</b><p><b style="color:#1f78b4;"></b></p>
<p>El siguiente mapa de calor también permite visualizar a la resolución de las variables morfométricas para diferenciar a las especies de peces, las cuales representan a los grupos en comparación. Con los siguientes comandos se calculará una tabla que resume a los <code>promedios</code> de las 10 variables morfométricas para cada especie evaluada.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracción de los promedios de las variables para cada especie</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>promedios <span class="ot">&lt;-</span> peces <span class="sc">%&gt;%</span>      </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="st">"Especie"</span>,<span class="st">"M.1"</span>,<span class="st">"M.2"</span>,<span class="st">"M.3"</span>,<span class="st">"M.4"</span>,<span class="st">"M.5"</span>,<span class="st">"M.6"</span>,<span class="st">"M.7"</span>,<span class="st">"M.13"</span>,<span class="st">"M.15"</span>,<span class="st">"M.18"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Especie) <span class="sc">%&gt;%</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), mean))</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>promedios  <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(promedios) <span class="co"># Guardar promedios como dataframe</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># promedios</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A continuación se comvierte el dataframe a formato matricial - <code>promedios2</code>, para poder ser graficado en el mapa de calor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Seleccionar columnas de 2 a 10 del data frame peces1 y convertirlas en matriz</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>promedios2 <span class="ot">&lt;-</span> promedios <span class="sc">%&gt;%</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>              <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">11</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">as.matrix</span>()</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(promedios2,<span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   M.1  M.2  M.3  M.4  M.5  M.6  M.7 M.13 M.15 M.18
1 0.38 0.87 0.27 0.30 0.11 0.12 0.69 0.59 0.35 0.35
2 0.32 0.76 0.25 0.25 0.11 0.13 0.66 0.52 0.34 0.33
3 0.36 0.85 0.26 0.29 0.11 0.13 0.68 0.56 0.29 0.31
4 0.37 0.90 0.26 0.28 0.13 0.15 0.70 0.45 0.39 0.40
5 0.48 0.76 0.28 0.31 0.13 0.16 0.88 0.62 0.28 0.18</code></pre>
</div>
</div>
<p>Ahora se incluyen los nombres de las especies a la matriz <code>promedios2</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Asignar los valores de la primera columna de peces1 como nombres de fila en la matriz peces2</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(promedios2) <span class="ot">&lt;-</span> promedios[,<span class="dv">1</span>]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La <a href="#fig-figura4">Figura&nbsp;4</a> permite visualizar a las variables que mejor discriminan a las especies de peces (variables de tonalidad rojiza).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figura del primer mapa de calor</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>hv <span class="ot">&lt;-</span> <span class="fu">heatmap</span>(promedios2, </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">margins=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">12</span>), </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">distfun =</span> dist,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">xlab =</span><span class="st">"Variables morfométricas"</span>, </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">ylab=</span> <span class="st">"Especie de Peces"</span>, </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">main =</span> <span class="st">"Clasificación de Peces"</span>) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller11.1.lda.peces_files/figure-html/fig-figura4-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;4: Mapa de calor que relaciona a las variables morfométricas y a las especies de peces.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>La <a href="#fig-figura5">Figura&nbsp;5</a> incorpora elementos adicionales como al método de agrupamiento <code>upgma</code>, asumiendo que puede ser el que mejor se ajusta a los datos de este ejercicio.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Opción 2. Mapa de calor con paquete "stats"</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>hclust.fq <span class="ot">&lt;-</span> <span class="cf">function</span>(promedios2) </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>             <span class="fu">hclust</span>(promedios2, <span class="at">method=</span><span class="st">"average"</span>)   <span class="co"># Inserción de UPGMA</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"gplots"</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap.2</span>(promedios2,         <span class="co"># Base de datos en formato matricial</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">margins=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">12</span>),    <span class="co"># Margenes de la figura</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">scale =</span> <span class="st">"row"</span>,      <span class="co"># Estandariza variables diferentes.</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="fu">bluered</span>(<span class="dv">100</span>),                 <span class="co"># Colores del mapa de calor</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span><span class="st">"Variables morfométricas"</span>, </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab=</span> <span class="st">"Especies de Peces"</span>, </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Clasificación de Peces"</span>,   </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">trace =</span> <span class="st">"none"</span>, </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">density.info =</span> <span class="st">"none"</span>,</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">distfun =</span> dist,          <span class="co"># Se puede usar vegdist de "vegan" </span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">hclustfun=</span>hclust.fq)     <span class="co"># Agrupamiento UPGMA</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura5" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller11.1.lda.peces_files/figure-html/fig-figura5-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;5: Mapa de calor que relaciona a las variables morfométricas y a las especies de peces.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="tres-pasos-para-la-realización-del-discriminante-lineal---lda" class="level1"><b style="color:#1f78b4;">
<h1>Tres pasos para la realización del discriminante lineal - LDA</h1>
</b><p><b style="color:#1f78b4;"></b></p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b><section id="paso-1.-pruebas-de-supuestos" class="level2"><b style="color:#1f78b4;">
<h2 class="anchored" data-anchor-id="paso-1.-pruebas-de-supuestos">Paso 1. Pruebas de supuestos</h2>
</b><p><b style="color:#1f78b4;"></b></p>
<p>Para que el análisis discriminante lineal sea considerado como un modelo lineal, debe cumplir con los supuestos de normalidad multivariada y de homogeneidad de covarianzas. Para el caso del presente ejercicio, dichos supuestos no alcanzan a cumplirse con los diagnosticos utilizados (valor p &gt; 0.05), motivo por el cual, el lda de este ejercicio será tomado como una técnica de exploración moltivariada para saber que tan bien discriminados quedan los individuos de cada especie, basado en las 10 variables morfométricas seleccionadas.</p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b><section id="supuesto-de-normalidad" class="level3"><b style="color:#1f78b4;">
<h3 class="anchored" data-anchor-id="supuesto-de-normalidad">1.1 Supuesto de normalidad</h3>
</b><p><b style="color:#1f78b4;"></b></p>
<p>El supuesto de normalidad multivariada será evaluado con el paquete <code>mvnormtest</code>, el cual utiliza el estadístico de <code>Shapiro Wilks Multivariado</code>. Para ello se realizará esta prueba en cada uno de los grupos o especies en comparación.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnóstico de normalidad por cada tipo de Especie</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvnormtest)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Los siguientes generan los dataframes de cada especie con las 10 variables seleccionadas, convirtiendola además en formato matricial.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dataframe por cada especie</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># datos de P. chola.</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>P.chola   <span class="ot">&lt;-</span> peces <span class="sc">%&gt;%</span> </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(Especie <span class="sc">==</span> <span class="st">"P. chola"</span>) <span class="sc">%&gt;%</span>       </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>             <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="st">"M.1"</span>,<span class="st">"M.2"</span>,<span class="st">"M.3"</span>,<span class="st">"M.4"</span>,<span class="st">"M.5"</span>,<span class="st">"M.6"</span>,<span class="st">"M.7"</span>,<span class="st">"M.13"</span>,<span class="st">"M.15"</span>,<span class="st">"M.18"</span>)) <span class="sc">%&gt;%</span>              <span class="fu">as.matrix</span>()</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co"># datos de P. conchonious.</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>P.concho  <span class="ot">&lt;-</span> peces <span class="sc">%&gt;%</span> </span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(Especie <span class="sc">==</span> <span class="st">"P. conchonious"</span>) <span class="sc">%&gt;%</span>       </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>             <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="st">"M.1"</span>,<span class="st">"M.2"</span>,<span class="st">"M.3"</span>,<span class="st">"M.4"</span>,<span class="st">"M.5"</span>,<span class="st">"M.6"</span>,<span class="st">"M.7"</span>,<span class="st">"M.13"</span>,<span class="st">"M.15"</span>,<span class="st">"M.18"</span>)) <span class="sc">%&gt;%</span>              <span class="fu">as.matrix</span>() </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="co"># datos de P. sophore.</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>P.sophore <span class="ot">&lt;-</span> peces <span class="sc">%&gt;%</span> </span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(Especie <span class="sc">==</span> <span class="st">"P. sophore"</span>) <span class="sc">%&gt;%</span>       </span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>             <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="st">"M.1"</span>,<span class="st">"M.2"</span>,<span class="st">"M.3"</span>,<span class="st">"M.4"</span>,<span class="st">"M.5"</span>,<span class="st">"M.6"</span>,<span class="st">"M.7"</span>,<span class="st">"M.13"</span>,<span class="st">"M.15"</span>,<span class="st">"M.18"</span>)) <span class="sc">%&gt;%</span>              <span class="fu">as.matrix</span>()     </span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="co"># datos de P. ticto.</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>P.ticto   <span class="ot">&lt;-</span> peces <span class="sc">%&gt;%</span> </span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(Especie <span class="sc">==</span> <span class="st">"P. ticto"</span>) <span class="sc">%&gt;%</span>       </span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>             <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="st">"M.1"</span>,<span class="st">"M.2"</span>,<span class="st">"M.3"</span>,<span class="st">"M.4"</span>,<span class="st">"M.5"</span>,<span class="st">"M.6"</span>,<span class="st">"M.7"</span>,<span class="st">"M.13"</span>,<span class="st">"M.15"</span>,<span class="st">"M.18"</span>)) <span class="sc">%&gt;%</span>              <span class="fu">as.matrix</span>()       </span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="co"># datos de P. ticto.</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>S.sarana  <span class="ot">&lt;-</span> peces <span class="sc">%&gt;%</span> </span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(Especie <span class="sc">==</span> <span class="st">"S. sarana"</span>) <span class="sc">%&gt;%</span>       </span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>             <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="st">"M.1"</span>,<span class="st">"M.2"</span>,<span class="st">"M.3"</span>,<span class="st">"M.4"</span>,<span class="st">"M.5"</span>,<span class="st">"M.6"</span>,<span class="st">"M.7"</span>,<span class="st">"M.13"</span>,<span class="st">"M.15"</span>,<span class="st">"M.18"</span>)) <span class="sc">%&gt;%</span>              <span class="fu">as.matrix</span>()  </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Vale la pena resaltar que los datos de las especies P. chola y P. sophore, son singulares, por lo cual no puede calcularse su supuesto de normalidad multivariada. Con el objeto de continuar en el ejercicio, las matrices que representan a las especies en mención, serán desactivadas con <code>#</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prueba de normalidad para cada especie</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># norm1 &lt;- mshapiro.test(t(P.chola))   # Matriz singular</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>norm2   <span class="ot">&lt;-</span> <span class="fu">mshapiro.test</span>(<span class="fu">t</span>(P.concho))</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># norm3 &lt;- mshapiro.test(t(P.sophore)) # Matriz singular</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>norm4   <span class="ot">&lt;-</span> <span class="fu">mshapiro.test</span>(<span class="fu">t</span>(P.ticto))</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>norm5   <span class="ot">&lt;-</span> <span class="fu">mshapiro.test</span>(<span class="fu">t</span>(S.sarana))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A continuación se resume el resultado de los tres diagnósticos de normalidad multivariada realizados. Vale la pena mencionar que ninguna especie cumple con dicho supuesto estadístico (valores p &lt; 0.05), aunque existe la posibilidad de probar con alguna transformación.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen de el diagnóstico de normalidad</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>(<span class="at">normalidad =</span> <span class="fu">data.frame</span>(<span class="at">Norm.P.concho =</span> norm2<span class="sc">$</span>p.value,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Norm.ticto    =</span> norm4<span class="sc">$</span>p.value,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Norm.sarana   =</span> norm5<span class="sc">$</span>p.value))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Norm.P.concho   Norm.ticto  Norm.sarana
1   0.001050723 2.629679e-08 5.169222e-07</code></pre>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="supuesto-de-homogeneidad-de-covarianzas" class="level3"><b style="color:#1f78b4;">
<h3 class="anchored" data-anchor-id="supuesto-de-homogeneidad-de-covarianzas">1.2 Supuesto de homogeneidad de covarianzas</h3>
</b><p><b style="color:#1f78b4;"></b></p>
<p>La prueba de homogeneidad de covarianza o <strong>esfericidad</strong>, corresponde al segundo supuesto del análisis discriminante lineal, se utilizará la función <code>betadisper</code>, la cual es complementada por dos análisis de varianza, los cuales definirán si el supuesto logra ser cumplido.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pruebas de Homogeneidad de covarianzas paquete "vegan"</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>peces.d <span class="ot">&lt;-</span> <span class="fu">dist</span>(peces[,<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>,<span class="dv">15</span>,<span class="dv">17</span>,<span class="dv">20</span>)])                <span class="co"># Matriz de distancias</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>peces.homoge <span class="ot">&lt;-</span> <span class="fu">betadisper</span>(peces.d, peces<span class="sc">$</span>Especie)      <span class="co"># Permutest</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Con la siguiente <code>anova</code> se obtiene un valor p de 0.016*, lo cual indica que NO se cumple el supuesto de homogeneidad de covarianzas (valor p &lt; 0.05).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Prueba con anova permutacional</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(peces.homoge)  </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Distances
          Df   Sum Sq   Mean Sq F value  Pr(&gt;F)  
Groups     4 0.019804 0.0049509   3.281 0.01638 *
Residuals 65 0.098082 0.0015090                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Con el <code>permutest</code> se obtiene un valor p de 0.016*, lo cual indica que tampoco se cumple el supuesto de homogeneidad de covarianzas (valor p &lt; 0.05).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Prueba permutacional</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(peces.homoge)   <span class="co"># Se cumple el supuesto de homogeneidad </span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 999

Response: Distances
          Df   Sum Sq   Mean Sq     F N.Perm Pr(&gt;F)  
Groups     4 0.019804 0.0049509 3.281    999  0.015 *
Residuals 65 0.098082 0.0015090                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="paso-2.-análisis-discriminante-lineal-de-fisher---lda" class="level2"><b style="color:#1f78b4;">
<h2 class="anchored" data-anchor-id="paso-2.-análisis-discriminante-lineal-de-fisher---lda">Paso 2. Análisis Discriminante Lineal de Fisher - LDA</h2>
</b><p><b style="color:#1f78b4;"></b></p>
<p>A continuación, se realizará el lda, que permitirá generar definir al nivel de discriminación de cada grupo o especie de pez. Se presentan algunas opciones gráficas con el procedimiento general y con el análisis discriminate canónico (dca)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cálculo del LDA</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(peces)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Especie" "Grupo"   "M.1"     "M.2"     "M.3"     "M.4"     "M.5"    
 [8] "M.6"     "M.7"     "M.8"     "M.9"     "M.10"    "M.11"    "M.12"   
[15] "M.13"    "M.14"    "M.15"    "M.16"    "M.17"    "M.18"    "M.19"   
[22] "M.20"    "M.21"    "M.22"    "M.23"    "M.24"    "M.25"    "M.26"   
[29] "M.27"    "M.28"    "M.29"   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>dis<span class="ot">&lt;-</span><span class="fu">lda</span> (Especie <span class="sc">~</span> M<span class="fl">.1</span><span class="sc">+</span>M<span class="fl">.2</span><span class="sc">+</span>M<span class="fl">.3</span><span class="sc">+</span>M<span class="fl">.4</span><span class="sc">+</span>M<span class="fl">.5</span><span class="sc">+</span>M<span class="fl">.6</span><span class="sc">+</span>M<span class="fl">.7</span><span class="sc">+</span>M<span class="fl">.13</span><span class="sc">+</span>M<span class="fl">.15</span><span class="sc">+</span>M<span class="fl">.18</span>,</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> peces)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(dis<span class="sc">$</span>prior,<span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      P. chola P. conchonious     P. sophore       P. ticto      S. sarana 
          0.17           0.11           0.09           0.29           0.34 </code></pre>
</div>
</div>
<p>“<em>Prior probabilities of groups</em>” corresponde a la probabilidad de clasificación para cada grupo que dependerá del número de peces que lo conforman, aquellas especies con mayor número de individuos censados, presentarán mayor probabilidad de discriminación.</p>
<p>Prbabilidad de clasificar indv. de los cinco grupos: P. chola P. conchonious P. sophore P. ticto S. sarana 0.17 0.11 0.09 0.29 0.34</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Insumos del AD </span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(dis)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A continuación se presentan los promedios de cada especie por cada variable morfométrica seleccionada para el análisis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Grupos de medias para las 4 variables </span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(dis<span class="sc">$</span>means,<span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                M.1  M.2  M.3  M.4  M.5  M.6  M.7 M.13 M.15 M.18
P. chola       0.38 0.87 0.27 0.30 0.11 0.12 0.69 0.59 0.35 0.35
P. conchonious 0.32 0.76 0.25 0.25 0.11 0.13 0.66 0.52 0.34 0.33
P. sophore     0.36 0.85 0.26 0.29 0.11 0.13 0.68 0.56 0.29 0.31
P. ticto       0.37 0.90 0.26 0.28 0.13 0.15 0.70 0.45 0.39 0.40
S. sarana      0.48 0.76 0.28 0.31 0.13 0.16 0.88 0.62 0.28 0.18</code></pre>
</div>
</div>
<p>Los autovalores son los que permiten definir las coordenadas de las variables para cada función canónica (eje o dimensión del lda), para la grafica del discriminante, se utilizarán las funciones <code>LD1</code> y <code>LD2</code>, como ejes <code>x</code> y <code>y</code> respectivamente (ver <span class="citation" data-cites="fi-figura6">@fi-figura6</span>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Autovalores estandarizados (pesos de las variables en cada eje)</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>((Cs <span class="ot">&lt;-</span> dis<span class="sc">$</span>scaling),<span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        LD1    LD2    LD3    LD4
M.1   39.34 -16.59  26.35  21.80
M.2  -13.21   7.17  12.49 -11.29
M.3   -6.94  -6.34  13.47  -0.45
M.4   18.73  51.95  25.65  -9.48
M.5  -17.12 -13.39 -35.00  44.46
M.6  -13.94 -45.46  -9.77 -52.02
M.7    6.98  -9.75  -4.18  -5.66
M.13  10.55  12.26  -5.03   5.43
M.15  -9.08  -8.91   9.32  21.28
M.18  -3.50  -4.82   2.14   4.19</code></pre>
</div>
</div>
<p>En el siguiente insumo se relacionan las coordenadas de las 6 primeras observaciones, las cuales también serán graficadas en la <span class="citation" data-cites="fi-figura6">@fi-figura6</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coordenadas de las seis primeras observaciones en cada eje canónico</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">head</span>(Fp <span class="ot">&lt;-</span> <span class="fu">predict</span>(dis)<span class="sc">$</span>x),<span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    LD1  LD2  LD3   LD4
1 -1.19 3.63 0.21 -0.41
2 -0.69 1.72 0.03  0.62
3 -2.64 3.04 1.36  3.00
4 -2.09 1.18 0.97  0.42
5 -1.45 2.47 1.56 -0.07
6 -1.31 2.95 2.77 -0.86</code></pre>
</div>
</div>
<p>La siguiente tabla es conocida como <strong>tabla de contingencia</strong> la cual realiza una validación cruzada entre las especies (filas) y los grupos discriminados por el lda (columnas). De acuerdo a esta tabla solo <em>P. sophore</em> no discrimina a todos sus individuos en su grupo, debido a que hay dos peces que presentan una morfometría más similar a <em>P. chola</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluación de desempeño del AD (método 1)</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(peces)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>group<span class="ot">&lt;-</span><span class="fu">predict</span>(dis,<span class="at">method=</span><span class="st">"plug-in"</span>)<span class="sc">$</span>class</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>(tabla<span class="ot">&lt;-</span><span class="fu">table</span>(Especie,group))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                group
Especie          P. chola P. conchonious P. sophore P. ticto S. sarana
  P. chola             12              0          0        0         0
  P. conchonious        0              8          0        0         0
  P. sophore            2              0          4        0         0
  P. ticto              0              0          0       20         0
  S. sarana             0              0          0        0        24</code></pre>
</div>
</div>
<p>La siguiente tabla realiza una validación en términos porcentuales, definiendo que en el caso de <em>P. sophore</em> el 64% de sus individuos discriminan correctamente en su especie. El resto de especies presentan una discriminación completa en su grupo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Porcentaje de clasificación correcta </span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">diag</span>(<span class="fu">prop.table</span>(tabla, <span class="dv">1</span>)),<span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      P. chola P. conchonious     P. sophore       P. ticto      S. sarana 
           100            100             67            100            100 </code></pre>
</div>
</div>
<p>La siguiente validación realizada por el método de Jacknife, presenta menos resolución de discriminación que la anterior, por lo cual no será tenida en cuenta en este ejercicio.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># M?todo 2: con clasifiación basada en jacknife (validación cruzada dejando uno afuera)</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>dis.jac <span class="ot">&lt;-</span> <span class="fu">lda</span>(Especie <span class="sc">~</span> M<span class="fl">.1</span><span class="sc">+</span>M<span class="fl">.2</span><span class="sc">+</span>M<span class="fl">.3</span><span class="sc">+</span>M<span class="fl">.4</span><span class="sc">+</span>M<span class="fl">.5</span><span class="sc">+</span>M<span class="fl">.6</span><span class="sc">+</span>M<span class="fl">.7</span><span class="sc">+</span>M<span class="fl">.13</span><span class="sc">+</span>M<span class="fl">.15</span><span class="sc">+</span>M<span class="fl">.18</span>,</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">data=</span>peces, <span class="at">CV=</span><span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Número y proporciones de clasificación correcta</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>clases.jac <span class="ot">&lt;-</span> dis.jac<span class="sc">$</span>class</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>tabla.jac <span class="ot">&lt;-</span> <span class="fu">table</span>(Especie, clases.jac)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>tabla.jac</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                clases.jac
Especie          P. chola P. conchonious P. sophore P. ticto S. sarana
  P. chola             10              0          2        0         0
  P. conchonious        0              7          0        1         0
  P. sophore            4              0          2        0         0
  P. ticto              0              0          0       20         0
  S. sarana             0              0          0        0        24</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Validación cruzada</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">diag</span>(<span class="fu">prop.table</span>(tabla.jac, <span class="dv">1</span>)),<span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      P. chola P. conchonious     P. sophore       P. ticto      S. sarana 
            83             88             33            100            100 </code></pre>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="paso-3.-visualización-grafica-del-lda" class="level2"><b style="color:#1f78b4;">
<h2 class="anchored" data-anchor-id="paso-3.-visualización-grafica-del-lda">Paso 3. Visualización grafica del LDA</h2>
<ul>
<li>** 3.1 Gráfico de elipses.**</li>
</ul>
</b><p><b style="color:#1f78b4;"></b></p>
<p>A continuación se realizará el componente grafico del lda, el cual inicia con una figura que definirá unas elipses, las cuales relacionan a los individuos de cada especie y cuyo solapamiento definirá el nivel de relación entre estas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Escores o coordenadas de las observaciones en cada eje can?nico</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>Fp <span class="ot">&lt;-</span> <span class="fu">predict</span>(dis)<span class="sc">$</span>x</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Grupos asignados por el AD</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>group<span class="ot">&lt;-</span><span class="fu">predict</span>(dis,<span class="at">method=</span><span class="st">"plug-in"</span>)<span class="sc">$</span>class</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coordenadas y grupos asignados</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>peces.coord<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">Especie=</span>group,Fp)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La <a href="#fig-figura6">Figura&nbsp;6</a> demuestra que si bien de presenta una buena discriminación de las especies de peces, 4 de las 5 evaluadas presentan cierta relación, definida por el solapamiento de sus elipses.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figura del LDA</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(peces)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">scatterplot</span>(LD2<span class="sc">~</span>LD1 <span class="sc">|</span> Especie, <span class="at">data=</span>peces.coord,<span class="at">reg.line=</span><span class="cn">FALSE</span>, </span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">smooth=</span>F, <span class="at">spread=</span>F,<span class="at">span=</span> <span class="dv">1</span>,<span class="at">grid=</span>F,</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend=</span><span class="fu">list</span>(<span class="at">coords=</span><span class="st">"bottom"</span>), </span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">ellipse=</span>T,<span class="at">font.lab=</span><span class="dv">2</span>, <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">16</span>,<span class="dv">17</span>,<span class="dv">18</span>,<span class="dv">19</span>),</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">col=</span><span class="fu">c</span>(<span class="st">'#fc8d59'</span>,<span class="st">'#e41a1c'</span>,<span class="st">'#984ea3'</span>,<span class="st">'#377eb8'</span>,<span class="st">'#33a02c'</span>),</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">main=</span><span class="st">"Análisis discriminante"</span>,</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">font.main=</span><span class="dv">2</span>,<span class="at">cex.main=</span><span class="dv">2</span>,<span class="at">cex.lab=</span><span class="fl">1.5</span>,</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">xlab=</span><span class="st">"Eje1"</span>, <span class="at">ylab=</span><span class="st">"Eje2"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura6" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller11.1.lda.peces_files/figure-html/fig-figura6-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;6: Mapa de calor que relaciona a las variables morfométricas y a las especies de peces.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
<ul>
<li>** 3.2 Gráfico del discriminante canónico - cda**</li>
</ul>
</b><p><b style="color:#1f78b4;"></b></p>
<p>El siguiente análisis permite visualizar la influencia de cada variable morfométrica en la separación de los grupos de especies y selecciona a las variables que presentan más influencia en la discriminación de los peces.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(peces)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(peces)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Especie" "Grupo"   "M.1"     "M.2"     "M.3"     "M.4"     "M.5"    
 [8] "M.6"     "M.7"     "M.8"     "M.9"     "M.10"    "M.11"    "M.12"   
[15] "M.13"    "M.14"    "M.15"    "M.16"    "M.17"    "M.18"    "M.19"   
[22] "M.20"    "M.21"    "M.22"    "M.23"    "M.24"    "M.25"    "M.26"   
[29] "M.27"    "M.28"    "M.29"   </code></pre>
</div>
</div>
<p>Lo primero que se realiza es el modelo lineal <code>mod</code> indicando las variables y los grupos a discriminar.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo Lineal multivariado con las variables morfom?tricas de peces</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">cbind</span>(M<span class="fl">.1</span>,M<span class="fl">.2</span>,M<span class="fl">.3</span>,M<span class="fl">.4</span>,M<span class="fl">.5</span>,M<span class="fl">.6</span>,M<span class="fl">.7</span>,M<span class="fl">.13</span>,M<span class="fl">.15</span>,M<span class="fl">.18</span>) <span class="sc">~</span> Especie,peces)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen del modelo multivariado</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mod)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Posteriormente realiza el discriminante canónico <code>can</code> que permite realizar la discriminación de los grupos en los ejes canónicos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Análisis discriminante canónico - ADC</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>can <span class="ot">&lt;-</span> <span class="fu">candisc</span>(mod, <span class="at">term=</span><span class="st">"Especie"</span>,<span class="at">data=</span>peces,<span class="at">ndim=</span><span class="dv">1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A continuación se presenta la figura que define a la discriminación de las especies con un solo eje canónico el cual explica el 81.8% de la variación de los datos. La orientación de los vectores (variables morfométricas), en relación a las cajas, indica su importancia para discriminar a cada especie o grupo en comparación.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(can,<span class="at">titles.1d =</span> <span class="fu">c</span>(<span class="st">"Puntuación canónica"</span>, <span class="st">"Estructura"</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figura7" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller11.1.lda.peces_files/figure-html/fig-figura7-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;7: Discriminante de las especies de peces con un eje canónico.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>En el siguiente enlace se puede obtener un caso aplicado con este tipo de análisis multivariados: <a href="https://www.redalyc.org/articulo.oa?id=180343692007">Aguirre et al.&nbsp;(2015)</a>. Ver la figura 2 del manuscrito en mención.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script>
</div> <!-- /content -->



</body></html>