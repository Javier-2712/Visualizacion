<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es-ES" xml:lang="es-ES"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Javier Rodríguez Barrios">
<meta name="dcterms.date" content="2023-03-17">

<title>Taller6. Opciones Gráficas</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Taller6.1.Explor.insectos_files/libs/clipboard/clipboard.min.js"></script>
<script src="Taller6.1.Explor.insectos_files/libs/quarto-html/quarto.js"></script>
<script src="Taller6.1.Explor.insectos_files/libs/quarto-html/popper.min.js"></script>
<script src="Taller6.1.Explor.insectos_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Taller6.1.Explor.insectos_files/libs/quarto-html/anchor.min.js"></script>
<link href="Taller6.1.Explor.insectos_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Taller6.1.Explor.insectos_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Taller6.1.Explor.insectos_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Taller6.1.Explor.insectos_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Taller6.1.Explor.insectos_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


<link rel="stylesheet" href="styles.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#exploración-gráfica-multivariada---base-insectos" id="toc-exploración-gráfica-multivariada---base-insectos" class="nav-link active" data-scroll-target="#exploración-gráfica-multivariada---base-insectos">Exploración gráfica multivariada - base <em>Insectos</em></a>
  <ul class="collapse">
  <li><a href="#procedimiento-de-la-exploración" id="toc-procedimiento-de-la-exploración" class="nav-link" data-scroll-target="#procedimiento-de-la-exploración">Procedimiento de la exploración</a>
  <ul class="collapse">
  <li><a href="#figuras-de-elipses" id="toc-figuras-de-elipses" class="nav-link" data-scroll-target="#figuras-de-elipses">1. Figuras de elipses</a></li>
  <li><a href="#figuras-de-dispersión-por-pares-de-variables-pairs" id="toc-figuras-de-dispersión-por-pares-de-variables-pairs" class="nav-link" data-scroll-target="#figuras-de-dispersión-por-pares-de-variables-pairs">3. Figuras de Dispersión por pares de variables (pairs)</a></li>
  <li><a href="#histogramas" id="toc-histogramas" class="nav-link" data-scroll-target="#histogramas">3. Histogramas</a></li>
  <li><a href="#dispersión-x-y" id="toc-dispersión-x-y" class="nav-link" data-scroll-target="#dispersión-x-y">4. Dispersión X-Y</a></li>
  <li><a href="#cajas-y-bigotes" id="toc-cajas-y-bigotes" class="nav-link" data-scroll-target="#cajas-y-bigotes">5. Cajas y Bigotes</a></li>
  <li><a href="#coplot" id="toc-coplot" class="nav-link" data-scroll-target="#coplot">6. Coplot</a></li>
  <li><a href="#figuras-con-estadísticos-promedios-errores" id="toc-figuras-con-estadísticos-promedios-errores" class="nav-link" data-scroll-target="#figuras-con-estadísticos-promedios-errores">7. Figuras con estadísticos (promedios, errores, …)</a></li>
  </ul></li>
  <li><a href="#taller-de-entrenamiento" id="toc-taller-de-entrenamiento" class="nav-link" data-scroll-target="#taller-de-entrenamiento"><strong>Taller de entrenamiento</strong></a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Taller6. Opciones Gráficas</h1>
<p class="subtitle lead">Nada Aún</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Autor/a</div>
    <div class="quarto-title-meta-contents">
             <p>Javier Rodríguez Barrios </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Fecha de publicación</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 17, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b><section id="exploración-gráfica-multivariada---base-insectos" class="level1"><b style="color:#1f78b4;">
<h1>Exploración gráfica multivariada - base <em>Insectos</em></h1>
</b><p><b style="color:#1f78b4;"></b></p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
<p><strong>Objetivo de la actividad:</strong></p>
</b><p><b style="color:#1f78b4;"></b></p>
<p>Poner en práctica el manejo de bases de datos y la visualización de datos uni, bi, tri y multivariados, para responder principalmente a dos tipos de objetivos:</p>
<ol type="1">
<li><p><strong>Relaciones</strong> entre variables biológicas y de estas con las ambientales (ej. figuras de elipses, pares, dispersión y coplot).</p></li>
<li><p><strong>Diferencias</strong> para el caso en el que contemos con variables agrupadoras (factores o v. cualitativas), orientado a evaluar las diferencias entre variables biológicas en gradientes espaciales o temporales (ej. entre grupos de sitios).</p></li>
</ol>
<p>La base de datos a utilizar se presenta en dos formatos: <strong>Insectos.csv</strong> e <strong>Insectos.xlsx</strong>. Esta base cuenta con 2 variables ambientales y 6 biológicas, así como con un factor o variable agrupadora (cuencas), todo esto distribuido en las columnas. Además cuenta con y 20 localidades o quebradas (filas).</p>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b><section id="procedimiento-de-la-exploración" class="level2"><b style="color:#1f78b4;">
<h2 class="anchored" data-anchor-id="procedimiento-de-la-exploración">Procedimiento de la exploración</h2>
</b><p><b style="color:#1f78b4;"></b></p>
<ul>
<li><p>Cargar librerías requeridas</p></li>
<li><p>Cargar la base <code>Insectos</code> (usar diferentes opciones para practicar)</p></li>
<li><p>Explorar al <strong>objetivo 1</strong> (figuras de elipses, pares, dispersión y coplot).</p></li>
<li><p>Explorar al <strong>objetivo 2</strong> (figuras de elipses, pares, dispersión y coplot).</p></li>
<li><p>Realizar las opciones gráficas relacionadas a los objetivos.</p></li>
<li><p>Realizar transformaciones de los datos, para mejorar la visualización de patrones.</p></li>
<li><p>Practicar con leyendas y resultados de la visualización realizada.</p></li>
</ul>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b><section id="cargar-las-librerías-requeridas" class="level4"><b style="color:#1f78b4;">
<h4 class="anchored" data-anchor-id="cargar-las-librerías-requeridas">Cargar las librerías requeridas</h4>
</b><p><b style="color:#1f78b4;"></b></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Librerías requeridas</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xtable)       <span class="co"># Importar y exportar</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)     <span class="co"># exportar "*.xlsx" </span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)       <span class="co"># Importar y exportar</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtable)       <span class="co"># Importar y exportar</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(stats)        <span class="co"># No se requiere instalar</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)      <span class="co"># No se requiere instalar</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)      <span class="co"># insertar rótulos a los puntos</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(SciViews)     <span class="co"># Fig. dispersión con coef. de pearson</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotrix)      <span class="co"># Figuras de cajas con múltiples variables</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)     <span class="co"># Figuras de elipses</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)        <span class="co"># Matrices de correlación para figuras de elipses</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)       <span class="co"># Requerido para figura de pares con ggpairs</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gganimate)    <span class="co"># Para figuras animadas de dispersión</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape)      <span class="co"># Figuras de cajas con múltiples variables</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)    <span class="co"># Para figuras estadísticas (varios factores)</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid)         <span class="co"># Para figuras estadísticas (varios factores)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><strong>Nota</strong>: <code>gganimate</code> requiere instalarse de la siguiente manera: <a href="https://spcanelon.notion.site/gganimate-How-to-Create-Plots-with-Beautiful-Animation-in-R-Datanovia-7193ba557c4345c3bbb6578b2b40e41f">ver_enlace_procedimiento</a></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">'gganimate'</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">'thomasp85/gganimate'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="cargar-o-importar-la-base-de-datos" class="level4"><b style="color:#1f78b4;">
<h4 class="anchored" data-anchor-id="cargar-o-importar-la-base-de-datos">Cargar o importar la base de datos</h4>
</b><p><b style="color:#1f78b4;"></b></p>
<p>A continuación se presentan tres formas diferentes de importar o cargar bases de dato, tanto en el formato original de Excel (xlsx) como en el formato plano (csv). Se utilizará la tercera opción para el resto del ejrcicio.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#------------</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"Insectos.xlsx"</span>)    <span class="co"># paquete "readxl" </span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(datos)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 10
  quebrada cuenca    pH  temp  Efem  Plec  Tric  Dipt  Cole    Ab
     &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1        1 cuen1    6.8  17.4    26     4     9    30     3    72
2        4 cuen1    7.3  16.8    17     6     9    25     1    58
3       11 cuen1    5.6  16       9     3    28    24     3    67
4       13 cuen1    6.3  17.8     2     3    25    21     6    57
5       19 cuen1    5.6  18.2     6     4    24    12    13    59
6        3 cuen2    6.3  17       7     2    25    10     1    45</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read_csv2</span>(<span class="st">"Insectos.csv"</span>)      <span class="co"># paquete "readxl"</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(datos)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 10
  quebrada cuenca    pH  temp  Efem  Plec  Tric  Dipt  Cole    Ab
     &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1        1 cuen1    6.8  17.4    26     4     9    30     3    72
2        4 cuen1    7.3  16.8    17     6     9    25     1    58
3       11 cuen1    5.6  16       9     3    28    24     3    67
4       13 cuen1    6.3  17.8     2     3    25    21     6    57
5       19 cuen1    5.6  18.2     6     4    24    12    13    59
6        3 cuen2    6.3  17       7     2    25    10     1    45</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read.csv2</span>(<span class="st">"Insectos.csv"</span>)      <span class="co"># paquete "utils"</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(datos)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  quebrada cuenca  pH temp Efem Plec Tric Dipt Cole Ab
1        1  cuen1 6.8 17.4   26    4    9   30    3 72
2        4  cuen1 7.3 16.8   17    6    9   25    1 58
3       11  cuen1 5.6 16.0    9    3   28   24    3 67
4       13  cuen1 6.3 17.8    2    3   25   21    6 57
5       19  cuen1 5.6 18.2    6    4   24   12   13 59
6        3  cuen2 6.3 17.0    7    2   25   10    1 45</code></pre>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="figuras-de-elipses" class="level3"><b style="color:#1f78b4;">
<h3 class="anchored" data-anchor-id="figuras-de-elipses">1. Figuras de elipses</h3>
</b><p><b style="color:#1f78b4;"></b></p>
<p>El Paquete <strong>corrplot</strong> es el que permite realizar las opciones gráficas de elipses a color, ingresar a este enlace:</p>
<p><a href="http://www.sthda.com/english/wiki/visualize-correlation-matrix-using-correlogram"><strong>corrplot</strong></a></p>
<p>Otro enlace a <strong>corrplot</strong>:</p>
<p><a href="https://cran.r-project.org/web/packages/corrplot/vignettes/corrplot-intro.html"><strong>corrplot</strong></a></p>
<p>Las figuras de correlación realizadas con el paquete <code>corrplot</code>, son una buena opción para evaluar los patrones generales de relaciones positivas (azul) y/o negativas (rojo), entre parejas de variables. Funcionan para objetivos orientados en la relaciones de (1) variables biológicas, (2) variables ambientales y (3) variables biológicas con las ambientales.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Elipses con colores</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">cor</span>(datos[,<span class="dv">3</span><span class="sc">:</span><span class="dv">10</span>])            <span class="co"># Matriz de Correlación (M)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La <a href="#fig-fig1">Figura&nbsp;1</a> muestra la relación entre las variables, a partir de figuras de elipses y de circulos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Elipses con colores</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(M, <span class="at">method =</span> <span class="st">"ellipse"</span>)  <span class="co"># Figura de correlaciones con elipses</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Elipses con colores</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(M, <span class="at">method =</span> <span class="st">"circle"</span>)   <span class="co"># Figura de correlaciones con circulos</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller6.1.Explor.insectos_files/figure-html/fig-fig1-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;1: Relación de variables ambientales y los taxones en las veinte quebradas estudiadas.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>La <a href="#fig-fig2">Figura&nbsp;2</a> muestra la relación entre las variables, a partir de figuras de elipses, además incorpora al nivel de correlación entre las parejas de variables con los coeficientes de Pearson.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Elipses con colores</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">X11</span>()</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot.mixed</span>(M, <span class="at">upper=</span><span class="st">"ellipse"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller6.1.Explor.insectos_files/figure-html/fig-fig2-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;2: Relación de variables ambientales y los taxones en las veinte quebradas estudiadas.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>La siguiente opción de correlación (<a href="#fig-fig3">Figura&nbsp;3</a>), presenta un código más compejo que las anteriores, pero permite generar una visualización más completa de las relaciones entre parejas de variables y sus coeficientes de correlación de Pearson (también se pueden probar otros coeficientes como Spearman o Kendall).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(M,  <span class="at">method =</span> <span class="st">"circle"</span>,            <span class="co"># Correlaciones con circulos</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="st">"lower"</span>, <span class="at">insig=</span><span class="st">"blank"</span>,    <span class="co"># Forma del panel</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">order =</span> <span class="st">"AOE"</span>, <span class="at">diag =</span> <span class="cn">FALSE</span>,      <span class="co"># Ordenar por nivel de correlación</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">addCoef.col =</span><span class="st">"black"</span>,             <span class="co"># Color de los coeficientes</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">number.cex =</span> <span class="fl">0.8</span>,                 <span class="co"># Tamaño del texto</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">COL2</span>(<span class="st">"RdYlBu"</span>, <span class="dv">200</span>))        <span class="co"># Transparencia de los circulos</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller6.1.Explor.insectos_files/figure-html/fig-fig3-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;3: Relación de variables ambientales y los taxones en las veinte quebradas estudiadas.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>La siguiente figura de correlaciones (<a href="#fig-fig4">Figura&nbsp;4</a>) es apropiada para casos en los que tenemos muchas variables biológicas (ej. tipos de taxones) e interesa evaluar su relación con las variables ambientales.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Elipses con colores</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>M1 <span class="ot">&lt;-</span> <span class="fu">cor</span>(datos[,<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>], datos[,<span class="dv">5</span><span class="sc">:</span><span class="dv">10</span>])            <span class="co"># Matriz de Correlación (M)</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Elipses con colores</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">X11</span>(<span class="dv">6</span>,<span class="dv">8</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(M1, <span class="at">method =</span> <span class="st">"ellipse"</span>, <span class="at">type=</span><span class="st">"upper"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller6.1.Explor.insectos_files/figure-html/fig-fig4-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;4: Relación de variables ambientales y los taxones en las veinte quebradas estudiadas.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="figuras-de-dispersión-por-pares-de-variables-pairs" class="level3"><b style="color:#1f78b4;">
<h3 class="anchored" data-anchor-id="figuras-de-dispersión-por-pares-de-variables-pairs">3. Figuras de Dispersión por pares de variables (pairs)</h3>
</b><p><b style="color:#1f78b4;"></b></p>
<p>El Paquete <strong>pairs</strong> es el que permite realizar las opciones gráficas de dispersión por parejas de variables, ingresar a este enlace:</p>
<p><a href="https://r-charts.com/es/correlacion/pairs/"><strong>pairs</strong></a></p>
<p>Otro enlace a <strong>pairs</strong>:</p>
<p><a href="https://r-coder.com/grafico-correlacion-r/"><strong>pairs</strong></a></p>
<p>Los gráficos de pares son complementarios a los de correlación, pero permiten conocer otros detalles en las relaciones entre parejas de variables (ej. relaciones lineaes vs.&nbsp;suavizadas o loess). En la siguiente figura (<a href="#fig-fig5">Figura&nbsp;5</a>), además de visualizar si la dispersión de los puntos se orienta hacia una relación positiva o negativa, entre más se ajuste la línea verde (tendencia lineal), con la negativa (tendencia no lineal, suavizada o loess), se puede precisar mejor, si hay una verdadera relación lineal entre las parejas de variables en comparación.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figuras de pares</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span> ((datos[,<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>)]),<span class="at">panel=</span><span class="cf">function</span>(x,y)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>{<span class="fu">abline</span>(<span class="fu">lsfit</span>(x,y)<span class="sc">$</span>coef,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="dv">3</span>)    <span class="co"># lwd = Ancho de la línea</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">lowess</span>(x,y),<span class="at">lty=</span><span class="dv">1</span>,<span class="at">lwd=</span><span class="dv">3</span>,<span class="at">col=</span><span class="dv">2</span>)    <span class="co"># col= Color de la línea</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(x,y,<span class="at">cex=</span><span class="dv">1</span>)}) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig5" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller6.1.Explor.insectos_files/figure-html/fig-fig5-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;5: Relación de variables ambientales y los taxones en las veinte quebradas estudiadas, con regresiones lineales y suavizadas.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Para la siguiente figura es primordial que lo que consideremos un factor, lo sea como tal. Si se observa la estructura de la base de datos de este ejemplo (<code>str(datos)</code>), se encontrará que R no asume a la columna “cuenca” como un factor (la asume como un caracter <code>chr</code>). En este sentdo, a continuación se convertirá en un factor, con el comando <code>as.factor</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustar el factor cuenca</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>cuenca <span class="ot">&lt;-</span> <span class="fu">as.factor</span> (datos<span class="sc">$</span>cuenca)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Es importante mencionar que estas figuras no son apropiadas para casos en los que se manejen demasiadas variables, para lo cual las elipses anteriores serán una mejor opción. En la siguiente figura (<a href="#fig-fig6">Figura&nbsp;6</a>) se seleccionan las cinco variables más correlacionadas y al final de la línea de código, se define al factor a graficar (<code>col=datos$cuenca</code>), que permitirá colocar colores a los puntos, de acurdo al tipo de cuenca al que pertenezcan.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Incluir el factor (cuenca)</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span> ((datos[,<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">10</span>)]),<span class="at">panel=</span><span class="cf">function</span>(x,y)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>{<span class="fu">abline</span>(<span class="fu">lsfit</span>(x,y)<span class="sc">$</span>coef,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">lowess</span>(x,y),<span class="at">lty=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(x,y,<span class="at">col=</span>datos<span class="sc">$</span>cuenca, <span class="at">cex=</span><span class="fl">1.4</span>,<span class="at">pch=</span><span class="dv">19</span>)})</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig6" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller6.1.Explor.insectos_files/figure-html/fig-fig6-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;6: Relación de variables ambientales y algunos taxones en las veinte quebradas estudiadas, con regresiones lineales y suavizadas, definiendo con colores a los grupos de cuencas.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>A continuación se presenta una variante a las figuras de pares (<a href="#fig-fig7">Figura&nbsp;7</a>), que por medio de la función <code>panel</code>, permite incorporar otros elementos en la matriz gráfica, como histogramas para visualizar el patrón de simetría de cada variable y el valor de correlación con coeficientes como el de Pearson. Las líneas rojas definen la relación no lineal o suavizada (loess o lowess) entre las parejas de variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlaciones de Pearson</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(SciViews)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(datos[,<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">10</span>)], <span class="at">diag.panel =</span> panel.hist, </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">upper.panel =</span> panel.cor, <span class="at">lower.panel =</span> panel.smooth)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig7" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller6.1.Explor.insectos_files/figure-html/fig-fig7-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;7: Relación de variables ambientales y algunos taxones en las veinte quebradas estudiadas, con regresiones suavizadas, coeficientes de correlación de Pearson e histogramas de frecuencia para cada variable.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b><section id="figuras-de-pares-en-ggplot2" class="level4"><b style="color:#1f78b4;">
<h4 class="anchored" data-anchor-id="figuras-de-pares-en-ggplot2">Figuras de pares en <strong>ggplot2</strong></h4>
</b><p><b style="color:#1f78b4;"></b></p>
<p>El Paquete <strong>ggpairs</strong> es el que permite realizar las opciones gráficas de dispersión por parejas de variables, ingresar a los siguientes enlaces:</p>
<p><a href="https://www.r-bloggers.com/2022/11/ggpairs-in-r/?utm_source=phpList&amp;utm_medium=email&amp;utm_campaign=R-bloggers-daily&amp;utm_content=HTML"><strong>ggpairs</strong></a></p>
<p><a href="https://r-graph-gallery.com/correlogram"><strong>ggpairs</strong></a></p>
<p><a href="https://r-charts.com/es/correlacion/ggpairs/"><strong>ggpairs</strong></a></p>
<p>La siguiente figura (<a href="#fig-fig8">Figura&nbsp;8</a>), es apropiado para pocos grupos de muestras (ej. &lt; 4 cuencas) y para pocas variables como las que se definen a continuación. También es recomendable realizarlas con muestras que presenten un número considerable de observaciones, lo cual permita tener una nube de puntos más definida.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figura de pares con cuatro variables seleccionadas</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(datos,                             <span class="co"># Data frame</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">columns =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">10</span>),             <span class="co"># Columnas o variables</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">color =</span> cuenca, <span class="at">alpha =</span> <span class="fl">0.5</span>),  <span class="co"># Color por cuenca</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">upper =</span> <span class="fu">list</span>(<span class="at">continuous=</span><span class="st">"points"</span>)) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig8" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller6.1.Explor.insectos_files/figure-html/fig-fig8-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;8: Relación de variables ambientales y pocos taxones en las veinte quebradas estudiadas, con colores para definir a las los lugares de cada cuenca evaluada.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>En la siguiente figura (<a href="#fig-fig9">Figura&nbsp;9</a>) se incorporan dos elementos adicionales, correspondientes a los coeficientes de correlación de Pearson y regresiones lineales, para cada grupo analizado (cuencas).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figura de pares incorporando coeficientes de correlación y regresiones lineales</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(datos, <span class="at">columns =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">10</span>), </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">color=</span>cuenca, <span class="at">alpha =</span> <span class="fl">0.5</span>),</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">lower=</span><span class="fu">list</span>(<span class="at">continuous=</span><span class="st">"smooth"</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig9" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller6.1.Explor.insectos_files/figure-html/fig-fig9-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;9: Relación de variables ambientales y algunos taxones en las veinte quebradas estudiadas, con regresiones lineales, coeficientes de correlación de Pearson e histogramas de frecuencia para cada variable.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="histogramas" class="level3"><b style="color:#1f78b4;">
<h3 class="anchored" data-anchor-id="histogramas">3. Histogramas</h3>
</b><p><b style="color:#1f78b4;"></b></p>
<p>Los presentes histogramas valoran el patron de distribución en la frecuencia de los datos de la abundancia de los insectos (variable Ab), en términos generales (<a href="#fig-fig10">Figura&nbsp;10</a>) y para cada cuenca estudiada (<a href="#fig-fig11">Figura&nbsp;11</a>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Frecuencias de abundancias </span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">histogram</span> (<span class="sc">~</span>Ab,<span class="at">data=</span>datos, <span class="at">ylab=</span><span class="st">"Porcentaje del Total"</span>,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab=</span><span class="st">"Abundancia de insectos"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig10" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller6.1.Explor.insectos_files/figure-html/fig-fig10-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;10: Patrón de distribución de la abundancia de insectos en las veinte quebradas evaluadas.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>El siguiente histograma (<a href="#fig-fig11">Figura&nbsp;11</a>), permite evaluar el patrón de abundancia de los insectos en cada cuenca evaluada.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Frecuencias de abundancias por cuencas</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">histogram</span> (<span class="sc">~</span>Ab<span class="sc">|</span>cuenca,<span class="at">data=</span>datos, <span class="at">ylab=</span><span class="st">"Porcentaje del Total"</span>,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab=</span><span class="st">"Abundancia de insectos"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig11" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller6.1.Explor.insectos_files/figure-html/fig-fig11-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;11: Patrón de distribución de la abundancia de insectos en las veinte quebradas y las cuatro cuencas evaluadas.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Las figuras de densidad (<a href="#fig-fig12">Figura&nbsp;12</a>) son otra forma de valorar la distribución de las frecuencias de las variables en estudio, pero suavizando o generando un gradiente contínuo de frecuencia.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Frecuencias de abundancias </span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">densityplot</span>(<span class="sc">~</span>Ab,<span class="at">data=</span>datos, <span class="at">ylab=</span><span class="st">"Porcentaje del Total"</span>,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">xlab=</span><span class="st">"Abundancia de insectos"</span>)  </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig12" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller6.1.Explor.insectos_files/figure-html/fig-fig12-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;12: Patrón de distribución de la abundancia de insectos en las veinte quebradas y las cuatro cuencas evaluadas.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>A continuación se muestra un histograma de frecuencias en la abundancia de los insectos (<a href="#fig-fig14">Figura&nbsp;13</a>), para cada cuenca evaluada, generando un patrón marcado que difiere para cada lugar evaluado.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Frecuencias de abundancias por cuencas</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">densityplot</span>(<span class="sc">~</span>Ab<span class="sc">|</span>cuenca,<span class="at">data=</span>datos, <span class="at">ylab=</span><span class="st">"Porcentaje del Total"</span>,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">xlab=</span><span class="st">"Abundancia de insectos"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig14" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller6.1.Explor.insectos_files/figure-html/fig-fig14-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;13: Patrón de distribución contínuo de la abundancia de insectos en las veinte quebradas evaluadas.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Las dos figuras que siguen (<a href="#fig-fig15">Figura&nbsp;14</a> y <a href="#fig-fig16">Figura&nbsp;15</a>), utilizan comandos del paquete <code>ggplot2</code> para visualizar de una forma más compacta a la distribución de frecuencias de la variable abundancia de insectos (AB) en las cuatro cuencas evaluadas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Frecuencias de abundancias por densidad</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> datos, <span class="fu">aes</span>(<span class="at">x =</span> Ab, <span class="at">color =</span> cuenca)) <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">fill =</span> cuenca), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">y=</span><span class="st">"Frecuencia"</span>, <span class="at">x=</span><span class="st">"Abundancia"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig15" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller6.1.Explor.insectos_files/figure-html/fig-fig15-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;14: Patrón de distribución contínuo de la abundancia de insectos en las veinte quebradas evaluadas.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Otra opción</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> datos, <span class="fu">aes</span>(<span class="at">x =</span> Ab, <span class="at">color =</span> cuenca)) <span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">fill =</span> cuenca)) <span class="sc">+</span> </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> cuenca)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig16" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller6.1.Explor.insectos_files/figure-html/fig-fig16-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;15: Patrón de distribución contínuo de la abundancia de insectos en las veinte quebradas y cuatro cuencas evaluadas.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="dispersión-x-y" class="level3"><b style="color:#1f78b4;">
<h3 class="anchored" data-anchor-id="dispersión-x-y">4. Dispersión X-Y</h3>
</b><p><b style="color:#1f78b4;"></b></p>
<p>El Paquete <strong><code>lattice</code></strong> es uno de los que permite realizar las opciones gráficas de dispersión, ingresar a este enlace:</p>
<p><a href="http://www.sthda.com/english/wiki/lattice-graphs"><strong>lattice</strong></a></p>
<p>A continuación se presenta una figura de dispersión (<a href="#fig-fig17">Figura&nbsp;16</a>), que relaciona a la abundancia de Efemerópteros con los niveles de pH, adicionalmente, se muestra el patrón de dispersión de los datos, en los que los colores representan a las diferentes cuencas evaluadas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Regresión lineal (esquema básico) </span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>cuenca <span class="ot">&lt;-</span> <span class="fu">as.factor</span> (datos<span class="sc">$</span>cuenca)  <span class="co"># cuenca como factor</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>(<span class="dv">8</span>,<span class="dv">6</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Efem<span class="sc">~</span>pH,                         <span class="co"># Relación pH vs. Efem</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">as.integer</span>(cuenca),          <span class="co"># Colores por tipo de cuencas</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">data=</span>datos, <span class="at">pch=</span><span class="dv">19</span>)              <span class="co"># Base de datos</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="fl">5.5</span>,<span class="dv">25</span>,                        <span class="co"># Coordenadas de la leyenda</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend=</span><span class="fu">levels</span>(datos<span class="sc">$</span>cuenca),   <span class="co"># Grupos de la leyenda</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch=</span><span class="dv">19</span>,<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">abline</span>(<span class="fu">lm</span>(datos<span class="sc">$</span>Efem<span class="sc">~</span>datos<span class="sc">$</span>pH), <span class="co"># regresión lineal</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">2</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig17" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller6.1.Explor.insectos_files/figure-html/fig-fig17-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;16: Relación entre el pH y la abundancia de Efemerópteros en las veinte quebradas y las cuatro cuencas evaluadas.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b><section id="dispersión-x-y-con-ggplot2" class="level4"><b style="color:#1f78b4;">
<h4 class="anchored" data-anchor-id="dispersión-x-y-con-ggplot2">Dispersión X-Y con <strong>ggplot2</strong></h4>
</b><p><b style="color:#1f78b4;"></b></p>
<p>El Paquete <strong>ggplot2</strong> es el que permite realizar las opciones gráficas de dispersión bivariados, ingresar a este enlace:</p>
<p><a href="https://rpubs.com/odenipinedo/introduction-to-data-visualization-with-ggplot2#:~:text=The%20diamonds%20dataset%20contains%20details,as%20in%20a%20scatter%20plot"><strong>RPubs</strong></a>.</p>
<p>Otro enlace a <strong>ggplot2</strong>:</p>
<p><a href="https://r-graph-gallery.com/scatterplot.html"><strong>ggplot2</strong></a></p>
<p>Las tres figuras que siguen, muestran opciones más compactas que la grafica anterior, para visualizar relaciones bivariadas en los descriptores en estudio, permitiendo también analizar el patrón de dispersión de los datos para cada cuenca evaluada (colores). La <a href="#fig-fig18">Figura&nbsp;17</a> permite visualizar la relación lineal incluyendo bandas grises que representan los límites de confianza de la proyección realizada.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Regresiones lineales (Esquema ggplot2) </span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos,<span class="fu">aes</span>(<span class="at">x =</span> pH,<span class="at">y =</span> Efem)) <span class="sc">+</span>   </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> cuenca), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span>  </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig18" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller6.1.Explor.insectos_files/figure-html/fig-fig18-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;17: Relación Lineal entre el pH y la abundancia de Efemerópteros en las veinte quebradas y las cuatro cuencas evaluadas.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>La <a href="#fig-fig19">Figura&nbsp;18</a>, a diferencia de la anterior, permite visualizar una relación suavizada en la pareja de variables en comparación. Esta relación no lineal es conocida como <code>Loess</code> o <code>Lowess</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Regresiones suavizadas - Loess o Lowess (Esquema ggplot2) </span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos,<span class="fu">aes</span>(<span class="at">x =</span> pH, <span class="at">y =</span> Efem)) <span class="sc">+</span>   </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> cuenca), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span>  </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig19" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller6.1.Explor.insectos_files/figure-html/fig-fig19-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;18: Relación Suavizada (Loess) entre el pH y la abundancia de Efemerópteros en las veinte quebradas y las cuatro cuencas evaluadas.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>En la <a href="#fig-fig20">Figura&nbsp;19</a> se eliminan los intervalos de confianza (bandas grises) y aumenta el suavizamiento con el comando <code>span = 0.4</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Regresiones suavizadas (Loess)</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos,<span class="fu">aes</span>(<span class="at">x =</span> pH, <span class="at">y =</span> Efem)) <span class="sc">+</span>   </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> cuenca), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span>  </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">span =</span> <span class="fl">0.4</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig20" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller6.1.Explor.insectos_files/figure-html/fig-fig20-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;19: Relación Suavizada (Loess) entre el pH y la abundancia de Efemerópteros en las veinte quebradas y las cuatro cuencas evaluadas.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="cajas-y-bigotes" class="level3"><b style="color:#1f78b4;">
<h3 class="anchored" data-anchor-id="cajas-y-bigotes">5. Cajas y Bigotes</h3>
</b><p><b style="color:#1f78b4;"></b></p>
<p>El Paquete <strong><code>lattice</code></strong> es uno de los que permite realizar las opciones gráficas de cajas, ingresar a este enlace:</p>
<p><a href="https://www.r-bloggers.com/2022/04/how-to-make-a-boxplot-in-r/?utm_source=phpList&amp;utm_medium=email&amp;utm_campaign=R-bloggers-daily&amp;utm_content=HTML"><strong>How to make a boxplot in R</strong></a></p>
<p>El Paquete <strong><code>ggplot2</code></strong> presenta opciones más estéticas y robustas para estas y muchas más figuras, ingresar a este enlace:</p>
<p><a href="https://r-charts.com/es/correlacion/grafico-dispersion-ggplot2/"><strong>Enlace1</strong></a></p>
<p><a href="https://soka.gitlab.io/blog/post/2019-04-25-r-ggplot2-scatterplot/"><strong>Enlace2</strong></a></p>
<p>Las figuras de cajas y bigotes, permiten visualizar medidas de tendencia central como las medianas (segundo cuartil) y el rango intercuartílico (límites de las cajas), es este caso, para el patrón de abundancia de los insectos en las cuatro cuencas evaluadas (<a href="#fig-fig21">Figura&nbsp;20</a>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figuras de Cajas y bigotes</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>cuenca<span class="ot">&lt;-</span><span class="fu">factor</span>(datos<span class="sc">$</span>cuenca, </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"cuen1"</span>,<span class="st">"cuen2"</span>,<span class="st">"cuen3"</span>,<span class="st">"cuen4"</span>))</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Cajas y Bigotes con muescas</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(Ab<span class="sc">~</span>cuenca,<span class="at">data=</span>datos,<span class="at">notch=</span><span class="cn">TRUE</span>,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab=</span><span class="st">"Cuencas"</span>,<span class="at">ylab=</span><span class="st">"Abundancia"</span>,</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">col=</span><span class="st">"lightgray"</span>, <span class="at">cex.lab=</span><span class="fl">1.3</span>)     <span class="co"># Probar con otros colores</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig21" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller6.1.Explor.insectos_files/figure-html/fig-fig21-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;20: Variación en la abundancia de insectos para las cuatro cuencas evaluadas.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Enlaces de <strong>paletas de colores</strong> para la edición de las figuras:</p>
<p><a href="https://colorbrewer2.org/#type=qualitative&amp;scheme=Set2&amp;n=4">colorbrewer</a></p>
<p><a href="https://colorbrewer2.org/#type=qualitative&amp;scheme=Set2&amp;n=4">coolors</a></p>
<p>A continuación se visualiza el patrón de variación en la abundancia de los insectos (<a href="#fig-fig22">Figura&nbsp;21</a>), para las cuatro cuencas evaluadas, adicionando colores especificos, tomados de los enlaces anteriores.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Buscar en google: colorbrewer2</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos, <span class="fu">aes</span>(<span class="at">x=</span>cuenca, <span class="at">y=</span>Ab)) <span class="sc">+</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> cuenca)) <span class="sc">+</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Cuencas"</span>, <span class="at">y=</span> <span class="st">"Abundancia de Insectos"</span>) <span class="sc">+</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'#fc8d59'</span>,<span class="st">'#ffffbf'</span>,<span class="st">'#99d594'</span>,<span class="st">'#377eb8'</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig22" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller6.1.Explor.insectos_files/figure-html/fig-fig22-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;21: Variación en la abundancia de insectos para las cuatro cuencas evaluadas.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>En la <a href="#fig-fig23">Figura&nbsp;22</a> se incluyen muescas a las cajas, para permitir hacer una comparación más precisa de las abundancias de los insectos en las cuencas evaluadas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Organización por nivel de magnitud</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(cuenca, Ab),<span class="at">y=</span>Ab)) <span class="sc">+</span> </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">notch =</span> T, <span class="fu">aes</span>(<span class="at">fill =</span> cuenca)) <span class="sc">+</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'#fc8d59'</span>,<span class="st">'#ffffbf'</span>,<span class="st">'#99d594'</span>,<span class="st">'#377eb8'</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig23" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller6.1.Explor.insectos_files/figure-html/fig-fig23-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;22: Variación en la abundancia de insectos para las cuatro cuencas evaluadas, incluyendo muescas en las cajas.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><strong>Paréntesis</strong> Base de datos de lirios (iris) para figura de violín (<a href="#fig-fig24">Figura&nbsp;23</a>). Estas figuras permiten visualizar la simetría en la distribución de las frecuencias de las variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># violin: como histograma acostado</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(<span class="at">x =</span> Species, <span class="at">y =</span> Sepal.Length)) <span class="sc">+</span> </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Species)) <span class="sc">+</span> </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>() <span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'#fc8d59'</span>,<span class="st">'#ffffbf'</span>,<span class="st">'#99d594'</span>)) <span class="sc">+</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig24" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller6.1.Explor.insectos_files/figure-html/fig-fig24-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;23: Variación en la abundancia de insectos para las cuatro cuencas evaluadas, mediante figuras de violines.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>La <a href="#fig-fig25">Figura&nbsp;24</a> muestra su versatilidad en que permite incorporar diferentes variables por cada panel presentado. Las cajas de colores representan a los grupos en comparación (cuencas).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figuras multivariadas de Cajas y bigotes</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">melt</span>(datos[,<span class="fu">c</span>(<span class="dv">2</span>,<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">10</span>))]), <span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>value)) <span class="sc">+</span> </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill=</span>cuenca)) <span class="sc">+</span> </span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'#fc8d59'</span>,<span class="st">'#ffffbf'</span>,<span class="st">'#99d594'</span>,<span class="st">'#377eb8'</span>)) <span class="sc">+</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">""</span>,<span class="at">y=</span><span class="st">"Abundancia"</span>) <span class="sc">+</span> </span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> variable,<span class="at">scales=</span><span class="st">"free"</span>) <span class="sc">+</span> </span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig25" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller6.1.Explor.insectos_files/figure-html/fig-fig25-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;24: Variación en la abundancia de diferentes taxones de insectos para las cuatro cuencas evaluadas.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="coplot" class="level3"><b style="color:#1f78b4;">
<h3 class="anchored" data-anchor-id="coplot">6. Coplot</h3>
</b><p><b style="color:#1f78b4;"></b></p>
<p>Las figuras de <code>coplot</code>, permiten relacionar a tres variables, en donde una de ellas puede ser continua o discreta, mediante segmentaciones.En la <a href="#fig-fig26">Figura&nbsp;25</a> se incorporan regresiones suavizadas (loess). Seis páneles en la relación pH y Efemerópteros se asocian a seis barras de temperatura, en donde el primer panel de la parte inferior se correlaciona con la primera barra de temperatura, ubicada a la izquierda y así sucesivamnte.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coplot con líneas de ajuste suavizado (loess)</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(datos, {</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coplot</span>(Efem<span class="sc">~</span>pH<span class="sc">|</span>temp,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">panel =</span> panel.smooth)})</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig26" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller6.1.Explor.insectos_files/figure-html/fig-fig26-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;25: Figura trivariada, en la que se intenta categorizar a la temperatura.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Para este caso (<strong>?@fig-fig27</strong>), se realiza una categorización de dos variables contínuas, que permitirán construir el coplot sin solapamiento de las barras de la tercera variable. Las relaciones se proyectan de forma lineal y el la siguiente ifura serán de forma suavizada.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Categorización de dos variables contínuas (pH y Temp)</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(datos[,<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       pH            temp            Efem            Plec           Tric      
 Min.   :5.50   Min.   :15.00   Min.   : 2.00   Min.   :0.00   Min.   : 7.00  
 1st Qu.:6.00   1st Qu.:15.95   1st Qu.: 6.00   1st Qu.:3.00   1st Qu.:15.00  
 Median :6.50   Median :17.05   Median :12.50   Median :4.00   Median :22.00  
 Mean   :6.48   Mean   :16.99   Mean   :13.75   Mean   :3.85   Mean   :20.95  
 3rd Qu.:7.00   3rd Qu.:17.88   3rd Qu.:19.00   3rd Qu.:5.00   3rd Qu.:25.00  
 Max.   :7.50   Max.   :19.80   Max.   :28.00   Max.   :8.00   Max.   :37.00  
      Dipt            Cole      
 Min.   : 0.00   Min.   : 1.00  
 1st Qu.:12.00   1st Qu.: 3.00  
 Median :24.50   Median : 6.00  
 Mean   :22.15   Mean   : 7.70  
 3rd Qu.:30.00   3rd Qu.:12.25  
 Max.   :39.00   Max.   :21.00  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>clasetemp <span class="ot">&lt;-</span> <span class="fu">cut</span>(datos<span class="sc">$</span>temp,<span class="fu">seq</span>(<span class="dv">15</span>,<span class="dv">20</span>,<span class="fl">1.2</span>),<span class="at">include.lowest=</span>T,</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"t.baja"</span>, <span class="st">"t.media1"</span>,<span class="st">"t.media2"</span>, <span class="st">"t.alta"</span>))</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>clasepH <span class="ot">&lt;-</span> <span class="fu">cut</span>(datos<span class="sc">$</span>pH,<span class="fu">seq</span>(<span class="dv">5</span>,<span class="dv">8</span>,<span class="dv">1</span>),<span class="at">include.lowest=</span>T,</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pH.bajo"</span>, <span class="st">"pH.medio"</span>,<span class="st">"pH.alto"</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Función para el coplot </span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>panel.lm <span class="ot">=</span> <span class="cf">function</span>(x, y, ...) {</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  tmp<span class="ot">&lt;-</span><span class="fu">lm</span>(y<span class="sc">~</span>x,<span class="at">na.action=</span>na.omit)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(tmp, <span class="at">lwd =</span> <span class="fl">1.5</span>, <span class="at">col=</span> <span class="dv">2</span>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(x,y, ...)}</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relación trivariada - Lineal</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coplot</span>(Efem<span class="sc">~</span>pH <span class="sc">|</span> clasetemp, <span class="at">pch=</span><span class="dv">19</span>,</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">panel =</span> panel.lm, <span class="at">data=</span>datos)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="fu">coplot</span>(Efem<span class="sc">~</span>pH <span class="sc">|</span> clasetemp, <span class="at">pch=</span><span class="dv">19</span>,</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">panel =</span> panel.smooth, <span class="at">data=</span>datos)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig28-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller6.1.Explor.insectos_files/figure-html/fig-fig28-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;26: Figura trivariada, Con la variable temperatura categorizada y relaciones suavizadas entre el pH y los Efemerópteros.</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-fig28-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller6.1.Explor.insectos_files/figure-html/fig-fig28-2.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;27: Figura trivariada, Con la variable temperatura categorizada y relaciones suavizadas entre el pH y los Efemerópteros.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="figuras-con-estadísticos-promedios-errores" class="level3"><b style="color:#1f78b4;">
<h3 class="anchored" data-anchor-id="figuras-con-estadísticos-promedios-errores">7. Figuras con estadísticos (promedios, errores, …)</h3>
</b><p><b style="color:#1f78b4;"></b></p>
<p>El Paquete <strong><code>ggplot2</code></strong> es uno de los que permite realizar las opciones gráficas de barras con estadísticos, ingresar a este enlace:</p>
<p><a href="https://rstudio-pubs-static.s3.amazonaws.com/355851_52530dca7f8a4355aad5f5ba46c88b42.html"><strong>Exploratory Data Analysis with ggplot</strong></a></p>
<p>Existen otros enlaces en los que se puede encontrar información complementaria para figuras de barras, como los siguientes</p>
<p><a href="https://rstudio-pubs-static.s3.amazonaws.com/355851_52530dca7f8a4355aad5f5ba46c88b42.html"><strong>ggplot2 barplots</strong></a></p>
<p><a href="https://appsilon.com/ggplot2-bar-charts/"><strong>Stunning Bar Charts</strong></a></p>
<p>A continuación se muestra el procedimiento con lenguaje Tidyverse, para realizar una tabla con el resumen de diferentes insumos estadísticos, para cada grupo (cuencas) de la base de datos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen estadístico "datos_resum"</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>datos_resum <span class="ot">&lt;-</span> datos <span class="sc">%&gt;%</span>        <span class="co"># Base de datos resumida</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cuenca) <span class="sc">%&gt;%</span>          <span class="co"># Factor o variable agrupadora</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">datos.m =</span> <span class="fu">mean</span>(Ab),   <span class="co"># Media de cada grupo del factor</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">datos.de  =</span> <span class="fu">sd</span>(Ab),   <span class="co"># Desviacioes estándar de cada grupo</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">datos.var =</span> <span class="fu">var</span>(Ab),  <span class="co"># Varianzas de cada grupo</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">n.Ab =</span> <span class="fu">n</span>(),           <span class="co"># Tamaño de cada grupo</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">datos.ee =</span> <span class="fu">sd</span>(Ab)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">n</span>()))   <span class="co"># Error estándar de cada grupo</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>datos_resum</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 6
  cuenca datos.m datos.de datos.var  n.Ab datos.ee
  &lt;fct&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt;
1 cuen1     62.6     6.58      43.3     5    2.94 
2 cuen2     49.2     5.40      29.2     5    2.42 
3 cuen3     73.8     1.30       1.7     5    0.583
4 cuen4     88      10.1      102.      5    4.53 </code></pre>
</div>
</div>
<p>La siguiente asignación (<code>DatosPlot</code>), incorpora las capas requeridas para realizar una figura de columnas y de líeas acotadas, que representan a los promedios y a los errores estándar respectivamente.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figura de promedios y errores estándar</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>DatosPlot<span class="ot">&lt;-</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(datos_resum, <span class="fu">aes</span>(cuenca, datos.m, <span class="fu">dev.off</span>())) <span class="sc">+</span> </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">col=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"#377eb8"</span>) <span class="sc">+</span>  </span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>datos.m<span class="sc">-</span>datos.ee, </span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax=</span>datos.m<span class="sc">+</span>datos.ee),<span class="at">width=</span><span class="fl">0.2</span>) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La asignación (<code>DatosPlot</code>), es tgraficada con el siguiente comando, en el que se incluyen elementos como los rótulos de los ejes (<code>labs</code>) y el tema de fondo (<code>theme_classic()</code>) (<a href="#fig-fig29">Figura&nbsp;28</a>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Imprimir la figura de promedios con errores estándar</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span> (DatosPlot <span class="sc">+</span> </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Abundancia ± e.e."</span>, </span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> <span class="st">"cuenca"</span>) <span class="sc">+</span> </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_fill_manual</span>(<span class="at">values=</span> <span class="fu">c</span>(<span class="st">"#A1D5D5"</span>)) <span class="sc">+</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_classic</span>())</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig29" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller6.1.Explor.insectos_files/figure-html/fig-fig29-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;28: Differencias en los promedios y errores estándar de la abundancia de insectos, para las cuatro cuencas.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Para la siguiente figura de Cajas y Bigotes, el comando <code>stat_boxplot(geom = "errorbar",...)</code> permite realizar gráficas sin necesidad de extraer algunos estadísticos previamente.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Opción de cajas y bigotes con errores estándar</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos, <span class="fu">aes</span>(<span class="at">x=</span>cuenca, <span class="at">y=</span> Ab, <span class="at">fill=</span> cuenca)) <span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">geom =</span> <span class="st">"errorbar"</span>,<span class="at">width =</span> <span class="fl">0.05</span>) <span class="sc">+</span> </span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.4</span>, </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">notchwidth =</span> <span class="fl">0.9</span>, <span class="at">outlier.colour=</span><span class="st">"red"</span>,</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">outlier.fill=</span><span class="st">"red"</span>,</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">outlier.size=</span><span class="dv">3</span>, <span class="at">outlier.alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">'#fc8d59'</span>,<span class="st">'#ffffbf'</span>,<span class="st">'#99d594'</span>,<span class="st">'#377eb8'</span>)) <span class="sc">+</span> </span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Cuencas"</span>, <span class="at">y =</span> <span class="st">"Abundancia ± e.e."</span>)<span class="sc">+</span> </span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">40</span>,<span class="dv">90</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig30" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller6.1.Explor.insectos_files/figure-html/fig-fig30-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;29: Differencias en la abundancia de insectos, para las cuatro cuencas.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b><section id="base-de-datos-con-múltiples-factores" class="level4"><b style="color:#1f78b4;">
<h4 class="anchored" data-anchor-id="base-de-datos-con-múltiples-factores">Base de datos con múltiples factores</h4>
</b><p><b style="color:#1f78b4;"></b></p>
<p>Lo que diferencia a esta base de datos (insectos1.csv) de la anterior (insectos.csv), es que presenta a diferentes variables agrupadoras o factores, como periodos de lluvia, Gruos Funcionales Alimenticios (GF) y Muestreos. Para el siguiente ejercicio se realizará el resumen estadístico de los dos primeros factores.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Base de datos multifactorial (insectos1)</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>datos1<span class="ot">&lt;-</span><span class="fu">read_csv2</span>(<span class="st">"Insectos2.csv"</span>)    <span class="co"># Formato *xlsx</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(datos1)  <span class="co"># Encabezado</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
     No Muestreo GF    Lluvia    Ab  Biom
  &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;
1     1 M1       C-F   P1        98 56.0 
2     2 M2       C-F   P1       198 52.7 
3     3 M3       C-F   P2        45 11.4 
4     4 M4       C-F   P2        51 25.3 
5     5 M5       C-F   P2         3  0.36
6     6 M6       C-F   P2        69 23.6 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen estadístico "datos_resum"</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>datos_resum <span class="ot">&lt;-</span> datos1 <span class="sc">%&gt;%</span>        <span class="co"># Base de datos resumida</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Lluvia,GF) <span class="sc">%&gt;%</span>          <span class="co"># Factor o variable agrupadora</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">datos.m =</span> <span class="fu">mean</span>(Biom),   <span class="co"># Media de cada grupo del factor</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">datos.de  =</span> <span class="fu">sd</span>(Biom),   <span class="co"># Desviacioes estándar de cada grupo</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">datos.var =</span> <span class="fu">var</span>(Biom),  <span class="co"># Varianzas de cada grupo</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">n.Biom =</span> <span class="fu">n</span>(),           <span class="co"># Tamaño de cada grupo</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">datos.ee =</span> <span class="fu">sd</span>(Biom)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">n</span>()))   <span class="co"># Error estándar de cada grupo</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>datos_resum</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 7
# Groups:   Lluvia [2]
   Lluvia GF    datos.m datos.de datos.var n.Biom datos.ee
   &lt;chr&gt;  &lt;chr&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;  &lt;int&gt;    &lt;dbl&gt;
 1 P1     C-F      37.0     30.0      902.      3    17.3 
 2 P1     C-R      31.7     32.1     1029.      3    18.5 
 3 P1     D       361.     120.     14411.      3    69.3 
 4 P1     R        53.5     69.8     4873.      3    40.3 
 5 P1     T       190.     296.     87533.      3   171.  
 6 P2     C-F      14.4     10.2      105.      5     4.58
 7 P2     C-R      88.5    115.     13273.      5    51.5 
 8 P2     D       176.      94.9     9010.      5    42.4 
 9 P2     R        21.9     12.9      165.      5     5.75
10 P2     T       151.     223.     49655.      5    99.7 </code></pre>
</div>
</div>
<p>Las asignaciones <code>f1</code> y <code>f2</code>, corresponden a las mismas figuras bifactoriales, en donde la primera se muestra con pocos ajustes de sus ejes y fondo, comparada a la segunda que presenta una mayor edición. Finalmente el comando <code>grid.arrange</code> permite graficar a las dos figuras en un mismo panel.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figura 1 (f1)</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">=</span> <span class="fu">ggplot</span>(datos_resum, <span class="fu">aes</span>(<span class="at">x=</span>GF, <span class="at">y=</span>datos.m, <span class="at">fill=</span>Lluvia)) <span class="sc">+</span> </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">position=</span><span class="fu">position_dodge</span>()) <span class="sc">+</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>datos.m, <span class="at">ymax=</span>datos.m<span class="sc">+</span>datos.de), <span class="at">width=</span>.<span class="dv">2</span>,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">9</span>)) </span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="co"># f2: Otro formato de figura bifactorial - theme_classic</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">=</span> f1<span class="sc">+</span><span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Biomasa por GF"</span>, </span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">x=</span><span class="st">"Grupos Funcionales - GF"</span>, </span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="st">"Biomasa"</span>)<span class="sc">+</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">'#E69F00'</span>,<span class="st">'#999999'</span>))</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Impresión de un panel con las dos figuras de forma horizontal (f1 y f2)</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span> (f1, f2, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig31" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller6.1.Explor.insectos_files/figure-html/fig-fig31-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;30: Differencias en la abundancia de insectos, los periodos de lluvia y para los grupos funcionales (GF).</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Cambiando la ubicación por columnas <code>ncol</code> por la de filas <code>nrow</code>, se cambia la posición de las figuras anteriores en el mismo panel.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Impresión de un panel con las dos figuras de forma vertical (p1 y p2)</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span> (f1, f2, <span class="at">nrow=</span><span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig32" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Taller6.1.Explor.insectos_files/figure-html/fig-fig32-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;31: Differencias en la abundancia de insectos, los periodos de lluvia y para los grupos funcionales (GF).</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="parentesis-figuras-de-dispersión-animadas" class="level4"><b style="color:#1f78b4;">
<h4 class="anchored" data-anchor-id="parentesis-figuras-de-dispersión-animadas"><strong>parentesis</strong> Figuras de dispersión animadas</h4>
</b><p><b style="color:#1f78b4;"></b></p>
<p><a href="https://spcanelon.notion.site/gganimate-How-to-Create-Plots-with-Beautiful-Animation-in-R-Datanovia-7193ba557c4345c3bbb6578b2b40e41f">Enlace</a></p>
<p><strong>Nota:</strong> ¡No estresarse en caso de que no se logre ejecutar esta figura!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gganimate)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())   <span class="co"># Tema o fondo de la figura por default</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Demo</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  gapminder, </span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y=</span>lifeExp, <span class="at">size =</span> pop, <span class="at">colour =</span> country)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">12</span>)) <span class="sc">+</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"GDP per capita"</span>, <span class="at">y =</span> <span class="st">"Life expectancy"</span>)</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">transition_time</span>(year) <span class="sc">+</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Year: {frame_time}"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="taller-de-entrenamiento" class="level2"><b style="color:#1f78b4;">
<h2 class="anchored" data-anchor-id="taller-de-entrenamiento"><strong>Taller de entrenamiento</strong></h2>
</b><p><b style="color:#1f78b4;"></b></p>
<p><strong>Objetivo:</strong> Poner en práctica los conceptos vistos en el módulo de exploratorios, realizando las siguientes opciones gráficas en las bases de datos de lirios <code>data(iris)</code>:</p>
<ol type="1">
<li><p>Figuras de elipses</p></li>
<li><p>Figuras de Dispersión por pares de variables (pairs)</p></li>
<li><p>Histogramas</p></li>
<li><p>Dispersión X-Y</p></li>
<li><p>Cajas y Bigotes</p></li>
<li><p>Coplot</p></li>
<li><p>Figuras con estadísticos (promedios, errores, …)</p></li>
</ol>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script>
</div> <!-- /content -->



</body></html>